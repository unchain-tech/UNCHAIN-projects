### ğŸ¦Š MetaMask ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹

ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ã‚‡ã†ã€‚

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯MetaMaskã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

- [ã“ã¡ã‚‰](https://MetaMask.io/download.html) ã‹ã‚‰ãƒ–ãƒ©ã‚¦ã‚¶ã®æ‹¡å¼µæ©Ÿèƒ½ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€MetaMaskã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚’ã‚ãªãŸã®ãƒ–ãƒ©ã‚¦ã‚¶ã«è¨­å®šã—ã¾ã™ã€‚

> âœï¸: MetaMask ãŒå¿…è¦ãªç†ç”±
> ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’å‘¼ã³å‡ºã™ã¨ãã€æœ¬äººã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ç§˜å¯†éµã‚’å‚™ãˆãŸã‚¦ã‚©ãƒ¬ãƒƒãƒˆãŒå¿…è¦ã¨ãªã‚Šã¾ã™ã€‚
> ã“ã‚Œã¯ã€èªè¨¼ä½œæ¥­ã®ã‚ˆã†ãªã‚‚ã®ã§ã™ã€‚

MetaMaskã‚’è¨­å®šã§ããŸã‚‰ã€Avalancheã®ãƒ†ã‚¹ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’è¿½åŠ ã—ã¾ã—ã‚‡ã†ã€‚

MetaMaskã®ä¸Šéƒ¨ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¿ãƒ–ã‚’é–‹ãã€`Add Network`ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

![](/public/images/AVAX-Messenger/section-2/2_3_2.png)

é–‹ã„ãŸè¨­å®šãƒšãƒ¼ã‚¸å†…ã§ä»¥ä¸‹ã®æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ä¿å­˜ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã—ã‚‡ã†ã€‚

```
Network Name: Avalanche FUJI C-Chain
New RPC URL: https://api.avax-test.network/ext/bc/C/rpc
ChainID: 43113
Symbol: AVAX
Explorer: https://testnet.snowtrace.io/
```

![](/public/images/AVAX-Messenger/section-2/2_3_3.png)

ç™»éŒ²ãŒæˆåŠŸã—ãŸã‚‰Avalancheã®ãƒ†ã‚¹ãƒˆãƒãƒƒãƒˆã§ã‚ã‚‹`Avalanche Fuji C-Chain`ãŒé¸æŠã§ãã‚‹ã¯ãšã§ã™ã€‚

![](/public/images/AVAX-Messenger/section-2/2_3_4.png)

### ğŸš° `Faucet`ã‚’åˆ©ç”¨ã—ã¦`AVAX`ã‚’ã‚‚ã‚‰ã†

ç¶šã„ã¦ã€[Avalanche Faucet](https://faucet.avax.network/)ã§`AVAX`ã‚’å–å¾—ã—ã¾ã™ã€‚

ãƒ†ã‚¹ãƒˆãƒãƒƒãƒˆã§ã®ã¿ä½¿ç”¨ã§ãã‚‹å½ã®`AVAX`ã§ã™ã€‚

ä¸Šè¨˜ãƒªãƒ³ã‚¯ã¸ç§»å‹•ã—ã¦ã€ã‚ãªãŸã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦avaxã‚’å—ã‘å–ã£ã¦ãã ã•ã„ã€‚
ğŸ’ ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯MetaMaskä¸Šéƒ¨ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåã®éƒ¨åˆ†ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã‚³ãƒ”ãƒ¼ãŒã§ãã¾ã™ã€‚

### ğŸŒ… `window.ethereum`ã‚’è¨­å®šã™ã‚‹

Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä¸Šã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨é€šä¿¡ã™ã‚‹ãŸã‚ã«ã¯ã€Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæƒ…å ±ã‚’å–å¾—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ã“ã‚Œã‹ã‚‰ã€ã‚ãªãŸã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚’æ¥ç¶šã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã€ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’å‘¼ã³å‡ºã™æ¨©é™ã‚’ä»˜ä¸ã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚ã“ã‚Œã¯ã€Webã‚µã‚¤ãƒˆã¸ã®èªè¨¼æ©Ÿèƒ½ã§ã™ã€‚

`window.ethereum`ã¯MetaMaskãŒ`window`ï¼ˆJavaScriptã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§å­˜åœ¨ã™ã‚‹ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ï¼‰ã®ç›´ä¸‹ã«ç”¨æ„ã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚ã‚ŠAPIã§ã™ã€‚
ã“ã®APIã‚’ä½¿ç”¨ã—ã¦ã€ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¤ãƒ¼ã‚µãƒªã‚¢ãƒ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’è¦æ±‚ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ¥ç¶šã—ã¦ã„ã‚‹ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿å–ã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚„å–å¼•ã«ç½²åã™ã‚‹ã‚ˆã†æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã¾ãšã¯`window.ethereum`ã‚’ä½¿ç”¨ã§ãã‚‹ã‚ˆã†typescriptã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã¾ã™ã€‚

### ğŸ“ `utils`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

`client`ã¸ç§»å‹•ã—`utils`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
ãã®ä¸­ã«`ethereum.ts`ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

```
client
â””â”€â”€ utils
    â””â”€â”€ ethereum.ts
```

`ethereum.ts`ã®ä¸­ã«ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è¨˜è¿°ã—ã¦ãã ã•ã„ã€‚

```ts
import { MetaMaskInpageProvider } from '@metamask/providers';

// window ã« ethereum ã‚’è¿½åŠ ã—ã¾ã™ã€‚
declare global {
  interface Window {
    ethereum?: MetaMaskInpageProvider;
  }
}

export const getEthereum = (): MetaMaskInpageProvider | null => {
  if (typeof window !== 'undefined' && typeof window.ethereum !== 'undefined') {
    const { ethereum } = window;
    return ethereum;
  }
  return null;
};
```

typescriptã§`window.ethereum`ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã«ã¯ã€`window`ã«`ethereum`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒã‚ã‚‹ã¨ã„ã†ã“ã¨ã‚’æ˜ç¤ºã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ã‚³ãƒ¼ãƒ‰å†…ã®ä»¥ä¸‹ã®éƒ¨åˆ†ã§`window`ã«`ethereum`ã‚’è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚
`MetaMaskInpageProvider`ã¯ç’°å¢ƒè¨­å®šæ™‚ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸ`@metamask/providers`ã‹ã‚‰å–å¾—ã—ãŸ`ethereum`ã®å‹å®šç¾©ã§ã™ã€‚

```ts
declare global {
  interface Window {
    ethereum?: MetaMaskInpageProvider;
  }
}
```

ã¾ãŸã€`getEthereum`é–¢æ•°ã‚’å‘¼ã³å‡ºã™ã¨`window`ã‹ã‚‰å–ã‚Šå‡ºã—ãŸ`ethereum`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å–å¾—ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

### ğŸ“ `hooks`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

ã¤ã¥ã„ã¦ãƒ¦ãƒ¼ã‚¶ãŒMetamaskã‚’æŒã£ã¦ã„ã‚‹ã“ã¨ã®ç¢ºèªã¨ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã¸ã®æ¥ç¶šæ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

æ—¢ã«ä½œæˆã—ã¦ã„ã‚‹`hooks`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã«`useWallet.ts`ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è¨˜è¿°ã—ã¦ãã ã•ã„ã€‚

```ts
import { useEffect, useState } from 'react';

import { getEthereum } from '../utils/ethereum';

// useWalletã®è¿”ã™ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å‹å®šç¾©ã§ã™ã€‚
type ReturnUseWallet = {
  currentAccount: string | undefined;
  connectWallet: () => void;
};

export const useWallet = (): ReturnUseWallet => {
  // ãƒ¦ãƒ¼ã‚¶ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ ¼ç´ã™ã‚‹ãŸã‚ã®çŠ¶æ…‹å¤‰æ•°ã‚’å®šç¾©ã—ã¾ã™ã€‚
  const [currentAccount, setCurrentAccount] = useState<string>();

  const ethereum = getEthereum();

  // ãƒ¦ãƒ¼ã‚¶ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚’webã‚¢ãƒ—ãƒªã¨æ¥ç¶šã—ã¾ã™ã€‚
  const connectWallet = async () => {
    try {
      if (!ethereum) {
        alert('Get MetaMask!');
        return;
      }
      // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å¯¾ã—ã¦ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã‚’æ±‚ã‚ã¾ã™ã€‚
      // eth_requestAccounts é–¢æ•°ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€MetaMask ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã™ã‚‹ã‚ˆã†å‘¼ã³ã‹ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
      const accounts = await ethereum.request({
        method: 'eth_requestAccounts',
      });
      if (!Array.isArray(accounts)) return;
      // è¨±å¯ã•ã‚Œã‚Œã°ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æœ€åˆã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ currentAccount ã«æ ¼ç´ã—ã¾ã™ã€‚
      console.log('Connected: ', accounts[0]);
      setCurrentAccount(accounts[0]);
    } catch (error) {
      console.log(error);
    }
  };

  // ãƒ¦ãƒ¼ã‚¶ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã¨webã‚¢ãƒ—ãƒªãŒæ¥ç¶šã—ã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚
  const checkIfWalletIsConnected = async () => {
    try {
      if (!ethereum) {
        console.log('Make sure you have MetaMask!');
        return;
      } else {
        console.log('We have the ethereum object', ethereum);
      }
      // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã¸ã‚¢ã‚¯ã‚»ã‚¹ãŒè¨±å¯ã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚
      const accounts = await ethereum.request({ method: 'eth_accounts' });
      if (!Array.isArray(accounts)) return;
      if (accounts.length !== 0) {
        const account = accounts[0];
        console.log('Found an authorized account:', account);
        setCurrentAccount(account);
      } else {
        console.log('No authorized account found');
      }
    } catch (error) {
      console.log(error);
    }
  };

  useEffect(() => {
    checkIfWalletIsConnected();
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, []);

  return {
    currentAccount,
    connectWallet,
  };
};
```

`useWallet`ã®å‡¦ç†ã‚’æ•´ç†ã—ã¾ã—ã‚‡ã†ã€‚

```ts
// ãƒ¦ãƒ¼ã‚¶ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ ¼ç´ã™ã‚‹ãŸã‚ã®çŠ¶æ…‹å¤‰æ•°ã‚’å®šç¾©ã—ã¾ã™ã€‚
const [currentAccount, setCurrentAccount] = useState<string>();

const ethereum = getEthereum();
```

ã¯ã˜ã‚ã«ãƒ¦ãƒ¼ã‚¶ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ ¼ç´ã™ã‚‹ãŸã‚ã®çŠ¶æ…‹å¤‰æ•°ã¨`ethereum`ã‚’ç”¨æ„ã—ã¾ã™ã€‚

```ts
// ãƒ¦ãƒ¼ã‚¶ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚’webã‚¢ãƒ—ãƒªã¨æ¥ç¶šã—ã¾ã™ã€‚
const connectWallet = async () => {
  // ...
};

// ãƒ¦ãƒ¼ã‚¶ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã¨webã‚¢ãƒ—ãƒªãŒæ¥ç¶šã—ã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚
const checkIfWalletIsConnected = async () => {
  // ...
};

useEffect(() => {
  checkIfWalletIsConnected();
  // eslint-disable-next-line react-hooks/exhaustive-deps
}, []);

return {
  currentAccount,
  connectWallet,
};
```

æ¬¡ã«2ã¤ã®é–¢æ•°ã‚’ä½œæˆã—ã¾ã—ãŸã€‚

`connectWallet`ã¯webã‚¢ãƒ—ãƒªãŒãƒ¦ãƒ¼ã‚¶ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã‚’æ±‚ã‚ã‚‹é–¢æ•°ã§ã€
ã“ã®å¾Œã®å®Ÿè£…ã§UIã«ãƒ¦ãƒ¼ã‚¶ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæ¥ç¶šãƒœã‚¿ãƒ³ã‚’ç”¨æ„ã—ã€ãã®ãƒœã‚¿ãƒ³ã¨ã“ã®é–¢æ•°ã‚’é€£æºã—ã¾ã™ã€‚
ãã®ãŸã‚å¤–éƒ¨ã§ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«è¿”ã‚Šå€¤ã®ä¸­ã«å«ã‚ã¦ã„ã¾ã™ã€‚

`checkIfWalletIsConnected`ã¯æ—¢ã«ãƒ¦ãƒ¼ã‚¶ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã¨webã‚¢ãƒ—ãƒªãŒæ¥ç¶šã—ã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹é–¢æ•°ã§ã€
`useEffect`ã‚’ä½¿ç”¨ã—ã¦webã‚¢ãƒ—ãƒªãŒãƒ¦ãƒ¼ã‚¶ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã™ã‚‹éš›ã«ã¯åˆå›ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ™‚ã«ç¢ºèªã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

> `eslint-disable-next-line react-hooks/exhaustive-deps`ã‚³ãƒ¡ãƒ³ãƒˆã«ã¤ã„ã¦
> `create-next-app`ã‚’å®Ÿè¡Œã—ãŸéš›ã«æ¨™æº–ã§`eslint`ã¨ã„ã†é™çš„è§£æãƒ„ãƒ¼ãƒ«ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã™ã€‚
> `eslint-disable-next-line react-hooks/exhaustive-deps`ã¯æ¬¡ã®è¡Œã‚’è§£æã‹ã‚‰å¤–ã™ã“ã¨ã‚’æŒ‡å®šã™ã‚‹ã‚³ãƒ¡ãƒ³ãƒˆã§ã™ã€‚
> ä»Šå›ã¯ useEffect ã®ä¾å­˜é…åˆ—ã«é–¢ã—ã¦ã€`eslint`ã®ãƒ«ãƒ¼ãƒ«ã«ããã‚ãªã„ãŸã‚ãã†ã—ã¦ã„ã¾ã™ã€‚

ã¾ãŸã€ãã‚Œãã‚Œã®é–¢æ•°å†…ã§ä½¿ç”¨ã—ã¦ã„ã‚‹`eth_requestAccounts`ã¨`eth_accounts`ã¯ã€ç©ºã®é…åˆ—ã¾ãŸã¯å˜ä¸€ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å«ã‚€é…åˆ—ã‚’è¿”ã™ç‰¹åˆ¥ãªãƒ¡ã‚½ãƒƒãƒ‰ã§ã™ã€‚
ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¦ã‚©ãƒ¬ãƒƒãƒˆã«è¤‡æ•°ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’æŒã£ã¦ã„ã‚‹å ´åˆã‚’è€ƒæ…®ã—ã¦ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®1ã¤ç›®ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—ã™ã‚‹ã“ã¨ã«ã—ã¦ã„ã¾ã™ã€‚

### ğŸ“ `layout`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã™ã‚‹ãƒšãƒ¼ã‚¸ï¼ˆä»Šå›ã¯å…¨ã¦ã®ãƒšãƒ¼ã‚¸ãŒãã†ã§ã™ï¼‰ã®ãŸã‚ã«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’ç”¨æ„ã—ã¾ã—ã‚‡ã†ï¼

æ—¢ã«ä½œæˆã—ãŸ`layout`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸­ã«`RequireWallet.module.css`ã¨`RequireWallet.tsx`ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

`RequireWallet.module.css`ã®ä¸­ã«ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è¨˜è¿°ã—ã¦ãã ã•ã„ã€‚

```css
.wallet {
  padding: 0 0 10px 0;
  border-bottom: 2px solid #eaeaea;
}

.wallet p {
  margin: 10px 0;
}

.title {
  font-size: 20px;
}
```

`RequireWallet.tsx`ã®ä¸­ã«ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è¨˜è¿°ã—ã¦ãã ã•ã„ã€‚

```ts
import styles from './RequireWallet.module.css';

type Props = {
  children: React.ReactNode;
  currentAccount: string | undefined;
  connectWallet: () => void;
};

export default function RequireWallet({
  children,
  currentAccount,
  connectWallet,
}: Props) {
  return (
    <div>
      {currentAccount ? (
        <div>
          <div className={styles.wallet}>
            <p className={styles.title}>wallet: </p>
            <p>{currentAccount}</p>
          </div>
          {children}
        </div>
      ) : (
        <button className="connectWalletButton" onClick={connectWallet}>
          Connect Wallet
        </button>
      )}
    </div>
  );
}
```

å¼•æ•°ã¨ã—ã¦å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨`currentAccount`ã€`connectWallet`ã‚’å—ã‘å–ã£ã¦ã„ã¾ã™ã€‚
`currentAccount`ï¼ˆãƒ¦ãƒ¼ã‚¶ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰ãŒã¾ã æ ¼ç´ã•ã‚Œã¦ã„ãªã„å ´åˆã¯`Connect Wallet`ã¨ã„ã†ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤ºã—ã€`connectWallet`é–¢æ•°ã¨é€£æºã—ã¦ã„ã¾ã™ã€‚

### ğŸ“ `pages`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

æœ€å¾Œã«ã€ã“ã‚Œã¾ã§ã«ä½œã£ãŸ`useWallet`ãƒ•ãƒƒã‚¯ã¨`RequireWallet`ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’å„ãƒšãƒ¼ã‚¸ã§ä½¿ç”¨ã—ã¾ã™ã€‚

`pages`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®å„ãƒšãƒ¼ã‚¸ã‚’ä»¥ä¸‹ã®å®Ÿè£…ã«å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚

`index.tsx`

```ts
import type { NextPage } from 'next';
import Link from 'next/link';

import Layout from '../components/layout/Layout';
import RequireWallet from '../components/layout/RequireWallet';
import { useWallet } from '../hooks/useWallet';
import styles from '../styles/Home.module.css';

const Home: NextPage = () => {
  const { currentAccount, connectWallet } = useWallet();

  return (
    <Layout home>
      <RequireWallet
        currentAccount={currentAccount}
        connectWallet={connectWallet}
      >
        <div className={styles.container}>
          <main className={styles.main}>
            <h1 className={styles.title}>Welcome to Messenger ğŸ“«</h1>
            <div className={styles.card}>
              <Link href="/message/SendMessagePage">
                <h2>send &rarr;</h2>
              </Link>
              <p>send messages and avax to other accounts</p>
            </div>

            <div className={styles.card}>
              <Link href="/message/ConfirmMessagePage">
                <h2>check &rarr;</h2>
              </Link>
              <p>Check messages from other accounts</p>
            </div>
          </main>
        </div>
      </RequireWallet>
    </Layout>
  );
};

export default Home;
```

`ConfirmMessagePage.tsx`

```ts
import { BigNumber } from 'ethers';

import MessageCard from '../../components/card/MessageCard';
import Layout from '../../components/layout/Layout';
import RequireWallet from '../../components/layout/RequireWallet';
import { Message } from '../../hooks/useMessengerContract';
import { useWallet } from '../../hooks/useWallet';

export default function ConfirmMessagePage() {
  const { currentAccount, connectWallet } = useWallet();

  const message: Message = {
    depositInWei: BigNumber.from('1000000000000000000'),
    timestamp: new Date(1),
    text: 'message',
    isPending: true,
    sender: '0x~',
    receiver: '0x~',
  };
  let ownMessages: Message[] = [message, message];

  return (
    <Layout>
      <RequireWallet
        currentAccount={currentAccount}
        connectWallet={connectWallet}
      >
        {ownMessages.map((message, index) => {
          return (
            <div key={index}>
              <MessageCard
                message={message}
                onClickAccept={() => {}}
                onClickDeny={() => {}}
              />
            </div>
          );
        })}
      </RequireWallet>
    </Layout>
  );
}
```

`SendMessagePage.tsx`

```ts
import SendMessageForm from '../../components/form/SendMessageForm';
import Layout from '../../components/layout/Layout';
import RequireWallet from '../../components/layout/RequireWallet';
import { useWallet } from '../../hooks/useWallet';

export default function SendMessagePage() {
  const { currentAccount, connectWallet } = useWallet();

  return (
    <Layout>
      <RequireWallet
        currentAccount={currentAccount}
        connectWallet={connectWallet}
      >
        <SendMessageForm
          sendMessage={(
            text: string,
            receiver: string,
            tokenInEther: string
          ) => {}}
        />
      </RequireWallet>
    </Layout>
  );
}
```

ãã‚Œãã‚Œã®ãƒšãƒ¼ã‚¸ã§ã¯åŒã˜å®Ÿè£…ã‚’è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚
`useWallet`ã‹ã‚‰`currentAccount`ã€`connectWallet`ã‚’å–å¾—ã—ã€`RequireWallet`ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã«æ¸¡ã—ã¦ã„ã¾ã™ã€‚

### ğŸŒ ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚³ãƒã‚¯ãƒˆã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹

ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã‚’ã™ã¹ã¦åæ˜ ã•ã›ãŸã‚‰ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ä¸Šã§ä¸‹è¨˜ã‚’å®Ÿè¡Œã—ã¾ã—ã‚‡ã†ã€‚

```
yarn client dev
```

ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼ã§Webã‚µã‚¤ãƒˆã‚’ç«‹ã¡ä¸Šã’ãŸã‚‰ã€MetaMaskã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ã‚ãªãŸã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ã®æ¥ç¶šçŠ¶æ³ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚

ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚’æ¥ç¶šã—ã¦ã„ãªã„çŠ¶æ…‹ã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¯ãšã§ã™ã€‚

![](/public/images/AVAX-Messenger/section-2/2_3_1.png)

`Connect Wallet`ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€MetaMaskã‚’æ¥ç¶šã—ã¦ãã ã•ã„ã€‚
âš ï¸ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«`Fuji`ã‚’é¸æŠã—ãŸçŠ¶æ…‹ã§è¡Œã£ã¦ãã ã•ã„ã€‚

ä¸‹å›³ã®ã‚ˆã†ã«MetaMaskã‹ã‚‰ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæ¥ç¶šã‚’æ±‚ã‚ã‚‰ã‚Œã¾ã™ã®ã§ã€æ‰¿èªã—ã¦ãã ã•ã„ã€‚

![](/public/images/AVAX-Messenger/section-2/2_3_5.png)

MetaMaskã®æ‰¿èªãŒçµ‚ã‚ã‚‹ã¨ã€ç”»é¢ãŒåˆ‡ã‚Šæ›¿ã‚ã‚Šã€ç”»é¢ä¸Šéƒ¨ã«ã‚ãªãŸã®æ¥ç¶šã—ã¦ã„ã‚‹ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

![](/public/images/AVAX-Messenger/section-2/2_3_6.png)

### ğŸŒ” å‚è€ƒãƒªãƒ³ã‚¯

> [ã“ã¡ã‚‰](https://github.com/unchain-tech/AVAX-Messenger)ã«æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å®Œæˆå½¢ã®ãƒ¬ãƒã‚¸ãƒˆãƒªãŒã‚ã‚Šã¾ã™ã€‚
>
> æœŸå¾…é€šã‚Šå‹•ã‹ãªã„å ´åˆã¯å‚è€ƒã«ã—ã¦ã¿ã¦ãã ã•ã„ã€‚


### ğŸ™‹â€â™‚ï¸ è³ªå•ã™ã‚‹

ã“ã“ã¾ã§ã®ä½œæ¥­ã§ä½•ã‹ã‚ã‹ã‚‰ãªã„ã“ã¨ãŒã‚ã‚‹å ´åˆã¯ã€Discordã®`#avalanche`ã§è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚

ãƒ˜ãƒ«ãƒ—ã‚’ã™ã‚‹ã¨ãã®ãƒ•ãƒ­ãƒ¼ãŒå††æ»‘ã«ãªã‚‹ã®ã§ã€ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒãƒ¼ãƒˆã«ã¯ä¸‹è¨˜ã®3ç‚¹ã‚’è¨˜è¼‰ã—ã¦ãã ã•ã„ âœ¨

```
1. è³ªå•ãŒé–¢é€£ã—ã¦ã„ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç•ªå·ã¨ãƒ¬ãƒƒã‚¹ãƒ³ç•ªå·
2. ä½•ã‚’ã—ã‚ˆã†ã¨ã—ã¦ã„ãŸã‹
3. ã‚¨ãƒ©ãƒ¼æ–‡ã‚’ã‚³ãƒ”ãƒ¼&ãƒšãƒ¼ã‚¹ãƒˆ
4. ã‚¨ãƒ©ãƒ¼ç”»é¢ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
```

---

ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæ¥ç¶šæ©Ÿèƒ½ãŒå®Œæˆã—ãŸã‚‰ã€æ¬¡ã®ãƒ¬ãƒƒã‚¹ãƒ³ã«é€²ã¿ã¾ã—ã‚‡ã† ğŸ‰
