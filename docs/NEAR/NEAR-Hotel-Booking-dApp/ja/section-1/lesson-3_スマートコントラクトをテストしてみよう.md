### ğŸ’» éƒ¨å±‹ã‚’ç™»éŒ²ãƒ»å–å¾—ã™ã‚‹æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¦ã¿ã‚ˆã†

å‰å›ã¾ã§ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ã€éƒ¨å±‹ã‚’ç™»éŒ²ãƒ»å–å¾—ã™ã‚‹ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆãŒä½œæˆã§ãã¾ã—ãŸã€‚ã“ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ã¯ã€å®Ÿéš›ã«æ©Ÿèƒ½ã—ã¦ã„ã‚‹ã‹ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ä¸Šã§ç¢ºèªã‚’ã—ã¦ã„ãã¾ã™ã€‚

ãƒ†ã‚¹ãƒˆã¯ä»¥ä¸‹ã®2ã¤ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚

1. ãƒ†ã‚¹ãƒˆç”¨ã®é–¢æ•°ã‚’èµ°ã‚‰ã›ã¦ã€æ€ã£ãŸé€šã‚Šã®æŒ™å‹•ã‚’ã™ã‚‹ã‹ä¸€æ°—ã«ãƒ†ã‚¹ãƒˆã™ã‚‹
2. å®Ÿéš›ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’ã—ã¦ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ä¸Šã‹ã‚‰é–¢æ•°ã‚’å‹•ã‹ã—ã¦ç¢ºèªã™ã‚‹

ã“ã“ã§ã¯ã€ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆå†…ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒã©ã®ã‚ˆã†ã«å‘¼ã³å‡ºã•ã‚Œã€çµæœãŒè¿”ã£ã¦ãã‚‹ã®ã‹ã‚’å®Ÿæ„Ÿã™ã‚‹ãŸã‚ã«ã€2. ã®æ–¹æ³•ã§ãƒ†ã‚¹ãƒˆã‚’è¡Œã„ãŸã„ã¨æ€ã„ã¾ã™ã€‚

### ğŸ‘¤ NEAR testnet ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹

ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’ã™ã‚‹ã«ã¯ã€NEAR testnetã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒå¿…è¦ã§ã™ã€‚[ã“ã¡ã‚‰](https://wallet.testnet.near.org/create)ã‹ã‚‰ä½œæˆã—ã¦ãã ã•ã„ã€‚æ—¢ã«ãŠæŒã¡ã®æ–¹ã¯ã€ã“ã¡ã‚‰ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’é£›ã°ã—ã¦ã„ãŸã ã„ã¦æ§‹ã„ã¾ã›ã‚“ã€‚

### âœ… ã€€ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’ã—ã¦ãƒ†ã‚¹ãƒˆã™ã‚‹

ã“ã“ã‹ã‚‰ã¯ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§æ“ä½œã‚’ã—ã¦ã„ãã¾ã™ã€‚ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹éšå±¤ã¯ã€`near-hotel-booking-dapp/contract`ã«ãªã‚Šã¾ã™ã€‚

ã¾ãšã¯ã€`Rust`ã§æ›¸ã‹ã‚ŒãŸã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦`Wasm`ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§å®Ÿè¡Œã—ã¾ã—ã‚‡ã†ã€‚

```
cargo build --target wasm32-unknown-unknown --release
```

ã“ã®ã‚ˆã†ãªå‡ºåŠ›ãŒã‚ã‚‹ã¨ã€æˆåŠŸã§ã™ã€‚

```
    Finished release [optimized] target(s) in 0.83s
```

å®Ÿéš›ã«ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚

```
ls ./target/wasm32-unknown-unknown/release | grep hotel_booking.wasm
```

ãƒ•ã‚¡ã‚¤ãƒ«åãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¯ãšã§ã™ã€‚

```
hotel_booking.wasm
```

æ¬¡ã«ã€ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’è¡Œã„ã¾ã™ã€‚ã“ã“ã‹ã‚‰ã¯ã€ç’°å¢ƒæ§‹ç¯‰æ™‚ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’ã—ãŸ`NEAR CLI`ã‚’ä½¿ã£ã¦ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‹ã‚‰ç›´æ¥NEARãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’æ“ä½œã—ã¦ã„ãã¾ã™ã€‚

ã¾ãšã¯ã€ãƒ­ã‚°ã‚¤ãƒ³ã‚’ã—ã¾ã™ã€‚ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```
near login
```

ä»Šå›ã¯ã€ã‚µãƒ–ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ãƒ†ã‚¹ãƒˆã‚’è¡Œã„ãŸã„ã¨æ€ã„ã¾ã™ã€‚ã‚µãƒ–ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½¿ç”¨ã™ã‚‹ãƒ¡ãƒªãƒƒãƒˆã¨ã—ã¦ã¯ã€ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’æ›´æ–°ã—ãŸéš›ã«ã‚µãƒ–ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç°¡å˜ã«æ¶ˆå»ãƒ»å†ä½œæˆã—ã¦ã€ã‚¼ãƒ­ã‹ã‚‰å§‹ã‚ã‚‹ã“ã¨ãŒã§ãã‚‹ãŸã‚ã§ã™ã€‚ã‚¼ãƒ­ã‹ã‚‰å§‹ã‚ã‚‹ç†ç”±ã¯ã€å¾Œã»ã©èª¬æ˜ã—ã¾ã™ã€‚

ã‚µãƒ–ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

```
near create-account ${SUBACCOUNT_ID}.${ACCOUNT_ID} --masterAccount ${ACCOUNT_ID} --initialBalance 5
```

ä¾‹ãˆã°ã€ã“ã®ã‚ˆã†ã«å®Ÿè¡Œã—ã¾ã™ã€‚

```
near create-account contract.hotel_booking.testnet --masterAccount hotel_booking.testnet --initialBalance 5
```

âš ï¸ ä»¥é™ã§ã¯ã€ä¸‹è¨˜ã®ã‚ˆã†ã«å®Ÿéš›ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆIDã‚’æŒ‡å®šã—ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚é©å®œã”è‡ªèº«ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆIDã«èª­ã¿æ›¿ãˆã¦ãã ã•ã„ã€‚

- ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã‚µãƒ–ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ : `contract.hotel_booking.testnet`
- éƒ¨å±‹ã®ã‚ªãƒ¼ãƒŠãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ : `hotel_booking.testnet`

ã‚µãƒ–ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚

```
near deploy --wasmFile target/wasm32-unknown-unknown/release/hotel_booking.wasm --accountId contract.hotel_booking.testnet
```

ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚ŒãŸã‚‰ãƒ‡ãƒ—ãƒ­ã‚¤ã¯æˆåŠŸã§ã™ï¼

```
Transaction Id 4QjCzpcZZ3Yj28wqCUEVtbV313duUXMN5nnWXBHM5GC7
To see the transaction in the transaction explorer, please open this url in your browser
https://explorer.testnet.near.org/transactions/4QjCzpcZZ3Yj28wqCUEVtbV313duUXMN5nnWXBHM5GC7
Done deploying to contract.hotel_booking.testnet
```

### ğŸ“ NEAR CLI ã§ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™æ–¹æ³•ã«ã¤ã„ã¦

`View`ãƒ¡ã‚½ãƒƒãƒ‰ã¨`Change`ãƒ¡ã‚½ãƒƒãƒ‰ã§ã€å¼•æ•°ã®æŒ‡å®šã‚„ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ç¨®é¡ãŒç•°ãªã‚Šã¾ã™ã€‚ä»¥ä¸‹ã¯ã‚³ãƒãƒ³ãƒ‰ã®ä¾‹ã«ãªã‚Šã¾ã™(è©³ã—ãã¯[ã“ã¡ã‚‰](https://docs.near.org/tools/near-cli#near-call))

`View`ãƒ¡ã‚½ãƒƒãƒ‰

```
near view [contractName] [method_name] [{ args ]]
```

`Change`ãƒ¡ã‚½ãƒƒãƒ‰

```
near call [contractName] [method_name] [{ args }] [--accountId]
```

### ğŸ“£ ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™

ã§ã¯ã€ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
ã¾ãšã¯ã€`get_rooms_registered_by_owner`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã‚“ã§ã¿ã¾ã™ã€‚

```
near view contract.hotel_booking.testnet get_rooms_registered_by_owner '{"owner_id": "hotel_booking.testnet"}' --accountId hotel_booking.testnet
```

ä»¥ä¸‹ã®ã‚ˆã†ãªå‡ºåŠ›ãŒè¿”ã•ã‚Œã¾ã™ã€‚

```
View call: contract.hotel_booking.testnet.get_rooms_registered_by_owner({"owner_id": "hotel_booking.testnet"})
[]
```

ã‚ªãƒ¼ãƒŠãƒ¼ã®`hotel_booking.testnet`ã¯éƒ¨å±‹ã‚’ç™»éŒ²ã—ã¦ã„ãªã„ã®ã§`[]`ãŒè¿”ã£ã¦ãã¾ã™ã€‚

æ¬¡ã«ã€`add_room_to_owner`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã‚“ã§éƒ¨å±‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç™»éŒ²ã—ã¦ã¿ã¾ã™ã€‚

ğŸ’¡ ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€éƒ¨å±‹ã®ç”»åƒã«`URL`ã‚’ç”¨ã„ã¾ã™ã€‚`"image": "URL"`ã«ã¯ã€ãŠå¥½ããªç”»åƒã®URLã‚’æŒ‡å®šã—ã¦ã¿ã¦ãã ã•ã„ã€‚

```
near call contract.hotel_booking.testnet add_room_to_owner '{"name": "Sun Room", "image": "URL", "beds": 1, "description": "This is Sun room.", "location": "Tokyo", "price": "1000000000000000000000000"}' --accountId hotel_booking.testnet
```

ä»¥ä¸‹ã®ã‚ˆã†ãªã‚‚ã®ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

```
Scheduling a call: contract.hotel_booking.testnet.add_room_to_owner({"name": "Sun Room", "image": "n URL", "beds": 1, "description": "This is Sun room.", "location": "Tokyo", "price": "1000000000000000000000000"})
Doing account.functionCall()
Transaction Id FaBHfU7UZraj8TMc8pbycoADfaoevhB3zQWzT2vb4qT6
To see the transaction in the transaction explorer, please open this url in your browser
https://explorer.testnet.near.org/transactions/FaBHfU7UZraj8TMc8pbycoADfaoevhB3zQWzT2vb4qT6
''
```

å†åº¦`get_rooms_registered_by_owner`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã‚“ã§ã¿ã¾ã™ã€‚

```
near view contract.hotel_booking.testnet get_rooms_registered_by_owner '{"owner_id": "hotel_booking.testnet"}' --accountId hotel_booking.testnet
```

ä»¥ä¸‹ã®ã‚ˆã†ãªã‚‚ã®ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

```
View call: contract.hotel_booking.testnet.get_rooms_registered_by_owner({"owner_id": "hotel_booking.testnet"})
[
  {
    name: 'Sun Room',
    image: 'none',
    beds: 1,
    description: 'This is Sun room.',
    location: 'Tokyo',
    price: '1000000000000000000000000',
    status: 'Available'
  }
]
```

ç™»éŒ²ã—ãŸéƒ¨å±‹ã®ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ãã¾ã—ãŸï¼

æœ€å¾Œã«ã€`exists`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç¢ºèªã—ã¾ã™ã€‚

```
near view contract.hotel_booking.testnet exists '{"owner_id": "hotel_booking.testnet", "room_name": "Sun Room"}' --accountId hotel_booking.testnet
```

`true`ãŒè¿”ã£ã¦ãã¾ã™ã€‚

```
View call: contract.hotel_booking.testnet.exists({"owner_id": "hotel_booking.testnet", "room_name": "Sun Room"})
true
```

ã§ã¯ã€æœªç™»éŒ²ã®ãƒ‡ãƒ¼ã‚¿ã‚’æŒ‡å®šã—ã¦ã¿ã¾ã™ã€‚

```
near view contract.hotel_booking.testnet exists '{"owner_id": "hotel_booking.testnet", "room_name": "Moon Room"}' --accountId hotel_booking.testnet
```

Moon Roomã¨ã„ã†åå‰ã®éƒ¨å±‹ã¯ç™»éŒ²ã—ã¦ã„ãªã„ã®ã§ã€`false`ãŒè¿”ã£ã¦ãã¾ã™ã€‚

```
View call: contract.hotel_booking.testnet.exists({"owner_id": "hotel_booking.testnet", "room_name": "Moon Room"})
false
```

ã“ã“ã¾ã§ã§ã€`get_rooms_registered_by_owner`ãƒ¡ã‚½ãƒƒãƒ‰ã€`add_room_to_owner`ãƒ¡ã‚½ãƒƒãƒ‰ã€`exists`ãƒ¡ã‚½ãƒƒãƒ‰ã¯ãã¡ã‚“ã¨æ©Ÿèƒ½ã™ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã—ãŸï¼

### ğŸ™‹â€â™‚ï¸ è³ªå•ã™ã‚‹

ã“ã“ã¾ã§ã®ä½œæ¥­ã§ä½•ã‹ã‚ã‹ã‚‰ãªã„ã“ã¨ãŒã‚ã‚‹å ´åˆã¯ã€Discordã®`#near`ã§è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚

ãƒ˜ãƒ«ãƒ—ã‚’ã™ã‚‹ã¨ãã®ãƒ•ãƒ­ãƒ¼ãŒå††æ»‘ã«ãªã‚‹ã®ã§ã€ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒãƒ¼ãƒˆã«ã¯ä¸‹è¨˜ã®4ç‚¹ã‚’è¨˜è¼‰ã—ã¦ãã ã•ã„ âœ¨

```
1. è³ªå•ãŒé–¢é€£ã—ã¦ã„ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç•ªå·ã¨ãƒ¬ãƒƒã‚¹ãƒ³ç•ªå·
2. ä½•ã‚’ã—ã‚ˆã†ã¨ã—ã¦ã„ãŸã‹
3. ã‚¨ãƒ©ãƒ¼æ–‡ã‚’ã‚³ãƒ”ãƒ¼&ãƒšãƒ¼ã‚¹ãƒˆ
4. ã‚¨ãƒ©ãƒ¼ç”»é¢ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
```

---

ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ ã‚»ã‚¯ã‚·ãƒ§ãƒ³1ã¯çµ‚äº†ã§ã™ âœ¨

`near view contract.hotel_booking.testnet exists '{"owner_id": "hotel_booking.testnet", "room_name": "Sun Room"}' --accountId hotel_booking.testnet`ã®çµæœã‚’`#near`ã«æŠ•ç¨¿ã—ã¦ã€ã‚ãªãŸã®æˆåŠŸã‚’ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã§ç¥ã„ã¾ã—ã‚‡ã† ğŸ‰

æ¬¡ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«é€²ã¿ã€ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®æ©Ÿèƒ½ã‚’æ‹¡å¼µã—ã¾ã—ã‚‡ã† ğŸš€
