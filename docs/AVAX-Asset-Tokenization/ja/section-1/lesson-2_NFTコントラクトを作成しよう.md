`section1`ã®ã“ã‚Œã‹ã‚‰å…ˆã®ä½œæ¥­ã¯ã€ `AVAX-Asset-Tokenization/packages/contract`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨ã—ã¦è©±ã‚’é€²ã‚ã¾ã™ã€‚ ğŸ™Œ

### ğŸ‘©â€ğŸ’» å®Ÿè£…ã™ã‚‹å†…å®¹ã®ç¢ºèª

æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ä½œæˆã™ã‚‹dappã®å†…å®¹ã‚’æ•´ç†ã—ã¾ã™ã€‚

è¾²å®¶ã¨ãã®åç©«ç‰©ã‚’è³¼å…¥ã™ã‚‹è³¼å…¥è€…ã‚’å¯¾è±¡ã«ã€NFTã®ä½œæˆã¨è³¼å…¥ãŒã§ãã‚‹ã‚¢ãƒ—ãƒªã‚’ä½œæˆã—ã¾ã™ã€‚

è¾²å®¶ã¯åç©«ç‰©ã‚’å¾—ã‚‹æ¨©åˆ©ã‚’ãƒˆãƒ¼ã‚¯ãƒ³ã¨ã—ã¦è³¼å…¥è€…ã«è²©å£²ã™ã‚‹ã“ã¨ã§ã€ åç©«ç‰©ã‚’ç›´æ¥å–å¼•ã™ã‚‹å½¢æ…‹ã®ä»–ã«ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³å‹ãªã©æ–°ãŸãªåå…¥å½¢æ…‹ã‚’å®Ÿç¾ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

è³¼å…¥è€…ã¯ãƒˆãƒ¼ã‚¯ãƒ³ã‚’NFTãƒãƒ¼ã‚±ãƒƒãƒˆã§è»¢å£²ã—ãŸã‚Šã€ ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ‰€æŒã—ã¦ã„ã‚‹äººã®ã¿å‚åŠ ã§ãã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã«å‚åŠ ã—ãŸã‚Šãªã©ã€ ä½“é¨“ã®å¹…ãŒåºƒãŒã‚Šã¾ã™ã€‚

ä»Šå›ä½œæˆã™ã‚‹ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã¯2ç¨®é¡ã§ã™ã€‚

**FarmNft**

NFTã®æ©Ÿèƒ½ã‚’æŒã¤ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã§ã™ã€‚
è¾²å®¶1ã¤ã«å¯¾ã—ã¦1ã¤ã®`FarmNft`ãŒãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¾ã™ã€‚

ã“ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã«ã¯æœ‰åŠ¹æœŸé™ã‚’è¨­ã‘ã¾ã™ã€‚
ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã«æŒ‡å®šã•ã‚ŒãŸæœ‰åŠ¹æœŸé™ã®æ—¥æ™‚ã‚’éãã‚‹ã¨NFTã®mintãŒã§ããªããªã‚Šã¾ã™ã€‚

**AssetTokenization**

ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ã®ãƒ‡ãƒ¼ã‚¿ã®ã‚„ã‚Šã¨ã‚Šã€ `FarmNft`ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ç®¡ç†ã‚’ã™ã‚‹æ©Ÿèƒ½ã‚’æŒã¤ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã§ã™ã€‚
`AssetTokenization`ã¯1ã¤ã§ã€ `FarmNft`ã¯è¾²å®¶ã®æ•°ã ã‘å­˜åœ¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ä½œæˆã™ã‚‹2ã¤ã®ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã¨ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ã®é–¢ä¿‚å›³ã¯ä»¥ä¸‹ã§ã™ã€‚

ã“ã“ã§ã¯`AssetTokenization`ãŒãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ã‚„ã‚Šå–ã‚Šã‚’ã™ã‚‹ã“ã¨ã¨ã€ è¤‡æ•°ã®`FarmNft`ã‚’ç®¡ç†ã—ã¦ã„ã‚‹ã¨ã„ã†é–¢ä¿‚æ€§ãŒæ´ã‚ã‚Œã°ååˆ†ã§ã™ï¼

![](/public/images/AVAX-Asset-Tokenization/section-1/1_1_2.png)

### ğŸ¥® `FarmNft`ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹

ã¾ãšã¯NFTã®æ©Ÿèƒ½ã‚’æŒã¤`FarmNft`ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

`contracts`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸‹ã«`FarmNft.sol`ã¨ã„ã†åå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

Hardhatã‚’ä½¿ç”¨ã™ã‚‹å ´åˆãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ã¯éå¸¸ã«é‡è¦ã§ã™ã®ã§ã€ æ³¨æ„ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ãŒä¸‹è¨˜ã®ã‚ˆã†ã«ãªã£ã¦ã„ã‚Œã°å¤§ä¸ˆå¤«ã§ã™ ğŸ˜Š

```diff
 contract/
  â””â”€â”€ contracts/
+     â””â”€â”€ FarmNft.sol
```

æ¬¡ã«ã€ ã‚³ãƒ¼ãƒ‰ã‚¨ãƒ‡ã‚£ã‚¿ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚³ãƒ¼ãƒ‰ã‚’é–‹ãã¾ã™ã€‚

`FarmNft.sol`ã®ä¸­ã«ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚

```solidity
// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.17;

import "@openzeppelin/contracts/token/ERC721/ERC721.sol";
import "@openzeppelin/contracts/utils/Base64.sol";
import "@openzeppelin/contracts/utils/Counters.sol";

contract FarmNft is ERC721 {
    address public farmerAddress;  //ã“ã®ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ä½œæˆã—ãŸè¾²å®¶ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä¿å­˜ã—ã¾ã™ã€‚
    string public farmerName; // è¾²å®¶ã®åå‰ã‚’ä¿å­˜ã—ã¾ã™ã€‚
    string public description; // NFTã«é–¢ã™ã‚‹èª¬æ˜æ–‡ã‚’ä¿å­˜ã—ã¾ã™ã€‚
    uint256 public totalMint; // mintã§ãã‚‹NFTã®ç·é‡ã‚’ä¿å­˜ã—ã¾ã™ã€‚
    uint256 public availableMint; // ç¾åœ¨mintã§ãã‚‹æ®‹ã‚Šã®NFTã®æ•°ã‚’ä¿å­˜ã—ã¾ã™ã€‚
    uint256 public price; // 1ã¤ã®NFTã®å€¤æ®µã‚’ä¿å­˜ã—ã¾ã™ã€‚
    uint256 public expirationDate; // ã“ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆè‡ªä½“ã®æœ‰åŠ¹æœŸé™ã‚’ä¿å­˜ã—ã¾ã™ã€‚

    using Counters for Counters.Counter;

    Counters.Counter private _tokenIds; // æ¬¡ã«mintã•ã‚Œã‚‹NFTã®idã‚’ä¿å­˜ã—ã¾ã™ã€‚

    constructor(
        address _farmerAddress,
        string memory _farmerName,
        string memory _description,
        uint256 _totalMint,
        uint256 _price,
        uint256 _expirationDate
    ) ERC721("Farm NFT", "FARM") {
        farmerAddress = _farmerAddress;
        farmerName = _farmerName;
        description = _description;
        totalMint = _totalMint;
        availableMint = _totalMint;
        price = _price;
        expirationDate = _expirationDate;
    }
}
```

ã‚‚ã—ã€`hardhat.config.ts`ã®ä¸­ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹Solidityã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒ`0.8.17`ã§ãªã‹ã£ãŸå ´åˆã¯ã€`FarmNft.sol`ã®ä¸­èº«ã‚’`hardhat.config.ts`ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«å¤‰æ›´ã—ã¾ã—ã‚‡ã†ã€‚

ã“ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã¯NFTã®æ©Ÿèƒ½ã‚’æŒãŸã›ãŸã„ + ç›£æŸ»ã®é€šã£ãŸã‚³ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ãŸã„ã®ã§ã€openzeppelinãŒæä¾›ã—ã¦ã„ã‚‹`ERC721`ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ç¶™æ‰¿ã—ã¦ã„ã¾ã™ã€‚

```
contract FarmNft is ERC721
```

ãã®ä¸‹ã«ã¯ã€ ã“ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®æƒ…å ±ã‚’ä¿å­˜ã§ãã‚‹ã‚ˆã†ã«çŠ¶æ…‹å¤‰æ•°ã‚’ç”¨æ„ã—ã¦ã„ã¾ã™ã€‚

constructorã§ã¯ã€ å¼•æ•°ã§å—ã‘å–ã£ãŸå€¤ã‚’å…ƒã«çŠ¶æ…‹å¤‰æ•°ã«å€¤ã‚’ä»£å…¥ã—ã¦ã„ã¾ã™ã€‚

æ¬¡ã«`FarmNft`ã®æœ€å¾Œã®è¡Œã«ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚

```solidity
    function mintNFT(address to) public payable {
        require(availableMint > 0, "Not enough nft");
        require(isExpired() == false, "Already expired");
        require(msg.value == price, "Incorrect amount of tokens");

        uint256 newItemId = _tokenIds.current();
        _safeMint(to, newItemId);
        _tokenIds.increment();
        availableMint--;

        (bool success, ) = (farmerAddress).call{value: msg.value}("");
        require(success, "Failed to withdraw AVAX");
    }

    function tokenURI(uint256 _tokenId)
        public
        view
        override
        returns (string memory)
    {
        string memory json = Base64.encode(
            bytes(
                string(
                    abi.encodePacked(
                        '{"name": "',
                        name(),
                        ' -- NFT #: ',
                        Strings.toString(_tokenId),
                        '", "description": "',
                        description,
                        '", "image": "',
                        'https://i.imgur.com/GZCdtXu.jpg',
                        '"}'
                    )
                )
            )
        );
        string memory output = string(
            abi.encodePacked("data:application/json;base64,", json)
        );
        return output;
    }

    function isExpired() public view returns (bool) {
        if (expirationDate < block.timestamp) {
            return true;
        } else {
            return false;
        }
    }

    function burnNFT() public {
        require(isExpired(), "still available");
        for (uint256 id = 0; id < _tokenIds.current(); id++) {
            _burn(id);
        }
    }

    function getTokenOwners() public view returns (address[] memory) {
        address[] memory owners = new address[](_tokenIds.current());
        for (uint256 index = 0; index < _tokenIds.current(); index++) {
            owners[index] = ownerOf(index);
        }
        return owners;
    }
```

1ã¤ãšã¤é–¢æ•°ã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

```solidity
    function mintNFT(address to) public payable {
        require(availableMint > 0, "Not enough nft");
        require(isExpired() == false, "Already expired");
        require(msg.value == price, "Incorrect amount of tokens");

        uint256 newItemId = _tokenIds.current();
        _safeMint(to, newItemId);
        _tokenIds.increment();
        availableMint--;

        (bool success, ) = (farmerAddress).call{value: msg.value}("");
        require(success, "Failed to withdraw AVAX");
    }
```

`mintNFT`ã¯NFTã®è³¼å…¥è€…(å¼•æ•°`to`ã«è³¼å…¥è€…ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ¸¡ã•ã‚Œã¾ã™)ã«mintã™ã‚‹é–¢æ•°ã§ã™ã€‚

ã¯ã˜ã‚ã«mintã®ã§ãã‚‹æ¡ä»¶ï¼ˆmintä¸Šé™ã‚’è¶…ãˆã¦ã„ãªã„ã‹ã€ æœŸé™åˆ‡ã‚Œã§ã¯ãªã„ã‹ã€NFTã®ä¾¡æ ¼åˆ†ã®ãƒˆãƒ¼ã‚¯ãƒ³ãŒä»˜ä¸ã•ã‚Œã¦ã„ã‚‹ã‹ï¼‰ã‚’`require`ã«ã‚ˆã‚Šç¢ºèªã—ã¦ã„ã¾ã™ã€‚

ä»Šå›ã¯å®Ÿè£…ã‚’ç°¡å˜ã«ã™ã‚‹ãŸã‚ã€NFTã®è³¼å…¥ã«Avalancheã®ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒˆãƒ¼ã‚¯ãƒ³ã§ã‚ã‚‹`AVAX`ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
ãã®ãŸã‚ã€ `mintNFT`é–¢æ•°ã®å‘¼ã³å‡ºã—ã«ä»˜ä¸ã•ã‚ŒãŸ`AVAX`ã®é‡ã‚’`msg.value`ã«ã‚ˆã‚Šå‚ç…§ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

æ¬¡ã«ã€ `_safeMint`ã«ã‚ˆã‚Š`to`ã«å¯¾ã—ã¦NFTã‚’mintã—ã¾ã™ã€‚
mintå¾Œã«idã®ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆã‚„mintå¯èƒ½ãªNFTã®æ•°ã‚’æ›´æ–°ã—ã¾ã™ã€‚

æœ€å¾Œã«ã€ è¾²å®¶ã«`AVAX`ã‚’é€ä¿¡ã—ã¾ã™ã€‚

```solidity
    function tokenURI(uint256 _tokenId)
        public
        view
        override
        returns (string memory)
    {
        string memory json = Base64.encode(
            bytes(
                string(
                    abi.encodePacked(
                        '{"name": "',
                        name(),
                        ' -- NFT #: ',
                        Strings.toString(_tokenId),
                        '", "description": "',
                        description,
                        '", "image": "',
                        'https://i.imgur.com/GZCdtXu.jpg',
                        '"}'
                    )
                )
            )
        );
        string memory output = string(
            abi.encodePacked("data:application/json;base64,", json)
        );
        return output;
    }
```

`tokenURI`ã¯JSONå½¢å¼ã«ã—ãŸNFTã®æƒ…å ±ã‚’URIã«ã—ã¦è¿”å´ã—ã¾ã™ã€‚
openseaãªã©ã®NFTãƒãƒ¼ã‚±ãƒƒãƒˆã‚µãƒ¼ãƒ“ã‚¹ã¯ã€ ã“ã®tokenURIé–¢æ•°ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã¿ã¦ã„ã¾ã™(è©³ã—ãã¯[ã“ã¡ã‚‰](https://docs.opensea.io/docs/metadata-standards#implementing-token-uri))ã€‚

ãƒˆãƒ¼ã‚¯ãƒ³åŒ–ã•ã‚ŒãŸè³‡ç”£ã‚’NFTãƒãƒ¼ã‚±ãƒƒãƒˆã§å–å¼•ã™ã‚‹ã¨ã„ã†ã‚ˆã†ãªæ´»ç”¨æ–¹æ³•ã‚’æƒ³å®šã—ãŸãŸã‚`tokenURI`ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ãŒã€ æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§å®Ÿéš›ã«åˆ©ç”¨ã™ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

```solidity
    function isExpired() public view returns (bool) {
        if (expirationDate < block.timestamp) {
            return true;
        } else {
            return false;
        }
    }
```

`isExpired`é–¢æ•°ã¯ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®æœ‰åŠ¹æœŸé™ãŒåˆ‡ã‚Œã¦ã„ã‚‹å ´åˆtrueã€ åˆ‡ã‚Œã¦ã„ãªã„å ´åˆã¯falseã‚’è¿”å´ã™ã‚‹é–¢æ•°ã§ã™ã€‚

> ğŸ““ `block.timestamp`ã®ä½¿ç”¨ã«ã¤ã„ã¦
> ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã§æ™‚é–“ã®å‚ç…§æ–¹æ³•ã¯ã„ãã¤ã‹ã‚ã‚Šã¾ã™ã€‚
> `block.timestamp`ã¯ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ã«ãƒ–ãƒ­ãƒƒã‚¯ãŒæ›¸ãè¾¼ã¾ã‚Œã‚‹éš›ã«ã€ ãƒãƒªãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã£ã¦æ“ä½œãŒã§ãã‚‹ã¨ã„ã†æ‡¸å¿µç‚¹ãŒã‚ã‚Šã¾ã™ãŒã€ æ“ä½œã®ã§ãã‚‹ç¯„å›²ã¯ 30 ç§’ã»ã©ã§ã™ã€‚
> ã¤ã¾ã‚Š 30 ç§’ã®ç¯„å›²ã§å®Ÿéš›ã¨ã¯å·®ã®ã‚ã‚‹æ™‚é–“ã‚’ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆå†…ã®ãƒ­ã‚¸ãƒƒã‚¯ã«ä½¿ç”¨ã—ã¦ã‚‚è‰¯ã„ã®ãªã‚‰`block.timestamp`ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚
> ä»Šå›ã¯ç°¡æ˜“çš„ãªå®Ÿè£…ãªã®ã§ã“ã¡ã‚‰ã‚’ä½¿ã„ã¾ã™ã€‚
> Ethereum ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã§ã¯ã€ `block.number`ã‚’ä½¿ç”¨ã—ãŸæ–¹æ³•([å‚è€ƒ](https://zoom-blc.com/solidity-time-logic))ãªã©ã‚‚ã‚ã‚Šã¾ã™ãŒã€ Avalanche ã§ã¯å®šæœŸçš„ã«ãƒ–ãƒ­ãƒƒã‚¯ãŒç”Ÿæˆã•ã‚Œã‚‹ã¨ã„ã†ä»•çµ„ã¿ã§ã¯ãªã„ãŸã‚ã“ã¡ã‚‰ã¯ä½¿ç”¨ã§ããªãã†ã§ã™ã€‚
> æ­£ç¢ºãªæƒ…å ±ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ã¯ã‚ªãƒ©ã‚¯ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```solidity
    function burnNFT() public {
        require(isExpired(), "still available");
        for (uint256 id = 0; id < _tokenIds.current(); id++) {
            _burn(id);
        }
    }
```

`burnNFT`ã¯ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®æœŸé™ãŒåˆ‡ã‚ŒãŸå¾Œã«æ—¢ã«ç™ºè¡Œã•ã‚Œã¦ã„ã‚‹NFTã‚’ãƒãƒ¼ãƒ³ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã—ã¾ã™ã€‚
ç™ºè¡Œæ¸ˆã¿ã®NFTã®æ•°ã ã‘ãƒ«ãƒ¼ãƒ—å‡¦ç†ã§ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ãƒãƒ¼ãƒ³ã—ã¾ã™ã€‚

```solidity
    function getTokenOwners() public view returns (address[] memory) {
        address[] memory owners = new address[](_tokenIds.current());
        for (uint256 index = 0; index < _tokenIds.current(); index++) {
            owners[index] = ownerOf(index);
        }
        return owners;
    }
```

`getTokenOwners`ã¯ç™ºè¡Œæ¸ˆã¿ã®NFTã®æ‰€æœ‰è€…ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’é…åˆ—ã«è©°ã‚ã¦è¿”å´ã™ã‚‹é–¢æ•°ã§ã™ã€‚

è¾²å®¶ãŒè‡ªã‚‰ãŒä½œæˆã—ãŸNFTã®è³¼å…¥è€…ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã—ã¾ã™ã€‚

### ğŸ§ª ãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã™ã‚‹

ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’å®Ÿè£…ã—ãŸã®ã§ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¾ã™ã€‚

ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã¯è©³ç´°ãªèª¬æ˜ã‚’çœãã¾ã™ãŒã€ ã‚³ãƒ¼ãƒ‰è‡ªä½“ã¯é‡ãŒå¤šã„ã®ã§Git hubä¸Šã‹ã‚‰ã‚³ãƒ”ãƒ¼ã—ã¦é ‚ããŸã„ã§ã™ã€‚

`test`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆã®ä¸‹ã«`FarmNft.ts`ã‚’ä½œæˆã—ã€ [ã“ã¡ã‚‰](https://github.com/unchain-dev/AVAX-Asset-Tokenization/blob/main/packages/contract/test/FarmNft.ts)ã®ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚

ã¾ãŸã€ ã“ã“ã§ãƒ†ã‚¹ãƒˆã«é–¢ã‚ã‚‹å‚è€ƒæ–‡çŒ®ã‚’ç´¹ä»‹ã—ã¾ã™ã®ã§ã“ã®å…ˆã®èª¬æ˜ã§ã‚ã‹ã‚‰ãªã„æ™‚ã¯å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚

ğŸ’ hardhatã§è¡Œã†ãƒ†ã‚¹ãƒˆã®è¨˜è¿°æ–¹æ³•ã«é–¢ã—ã¦ã¯[ã“ã¡ã‚‰](https://hardhat.org/hardhat-runner/docs/guides/test-contracts)ã€‚

ğŸ’ ãƒ•ã‚¡ã‚¤ãƒ«å†’é ­ã«`chai`ã¨ã„ã†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‹ã‚‰`expect`ã‚’importã—ã¦ã„ã¾ã™ã€‚`expect`ã®ä½¿ã„æ–¹ã«é–¢ã—ã¦ã¯[ã“ã¡ã‚‰](https://hardhat.org/hardhat-chai-matchers/docs/reference)ã€‚

ğŸ’ ãƒ•ã‚¡ã‚¤ãƒ«å†’é ­ã«`hardhat-network-helpers`ã¨ã„ã†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‹ã‚‰`loadFixture`ã¨`time`ã‚’importã—ã¦ã„ã¾ã™ã€‚ãã‚Œãã‚Œä½¿ã„æ–¹ã«é–¢ã—ã¦ã¯[ã“ã¡ã‚‰](https://hardhat.org/hardhat-network-helpers/docs/reference)ã€‚

ãã‚Œã§ã¯ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã„ãã¾ã™ã€‚

ä»¥ä¸‹ã®ã‚ˆã†ã«ã€ å„ãƒ†ã‚¹ãƒˆã§å‘¼ã³å‡ºã•ã‚Œã‚‹`deployContract`ã¨ãã®å¾Œã«ç¶šããƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ãŒè¨˜è¿°ã•ã‚Œã¦ã„ã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚

```ts
describe('farmNft', function () {
  const oneWeekInSecond = 60 * 60 * 24 * 7;

  async function deployContract() {
    // ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤
  }

  // ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
});
```

`deployContract`å†…ã§ã¯ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤ä½œæ¥­ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚
è¿”ã‚Šå€¤ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã«ä½¿ç”¨ã—ãŸã‚¢ã‚«ã‚¦ãƒ³ãƒˆã€ ãã®ä»–ã«ä½¿ç”¨ã§ãã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã€ ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒã‚ã‚Šã¾ã™ã€‚
ã“ã®é–¢æ•°ã¯å„ãƒ†ã‚¹ãƒˆã§æœ€åˆã«å‘¼ã°ã‚Œã¾ã™ã€‚

æ¬¡ã«ä»¥ä¸‹ã®ã‚ˆã†ãªå½¢ã§`mint`ã«é–¢ã™ã‚‹ãƒ†ã‚¹ãƒˆãŒ4ã¤è¨˜è¿°ã•ã‚Œã¦ã„ã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚

```ts
describe('mint', function () {
  it('NFT should be minted', async function () {
    // ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
  });

  it('balance should be change', async function () {
    // ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
  });

  it('revert when not enough nft to mint', async function () {
    // ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
  });

  it('revert when not enough currency to mint', async function () {
    // ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
  });
});
```

1ã¤ç›®ã®ãƒ†ã‚¹ãƒˆã§ã¯NFTã‚’mintã—ãŸå¾Œã€ ãã®NFTã®ä¿æœ‰è€…ãŒæŒ‡å®šã—ãŸã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ä¸€è‡´ã™ã‚‹ã‹ã‚’ãƒ†ã‚¹ãƒˆã—ã¦ã„ã¾ã™ã€‚
2ã¤ç›®ã®ãƒ†ã‚¹ãƒˆã§ã¯mintNFTã®å®Ÿè¡Œæ™‚ã«AVAXã®ç§»å‹•ãŒæ­£ã—ãè¡Œã‚ã‚Œã¦ã„ã‚‹ã®ã‹ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ã€‚
3ã¤ç›®ã®ãƒ†ã‚¹ãƒˆã§ã¯ä¸Šé™ã¾ã§NFTãŒmintã•ã‚Œã¦ã„ã‚‹å ´åˆã«mintNFTã®å‘¼ã³å‡ºã—ãŒå¤±æ•—ã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ã€‚
4ã¤ç›®ã®ãƒ†ã‚¹ãƒˆã§ã¯é–¢æ•°å‘¼ã³å‡ºã—ã«ä»˜ä¸ã—ãŸAVAXãŒè¶³ã‚Šãªã„å ´åˆã«ã€mintNFTã®å‘¼ã³å‡ºã—ãŒå¤±æ•—ã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ã€‚

ãã®ä¸‹ã®`describe('tokenURI', function () { ...`ã«ç¶šããƒ†ã‚¹ãƒˆã§ã¯ã€ `tokeURI`ã®æŒ™å‹•ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ã€‚
`tokeURI`ã¯æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ä½¿ç”¨ã—ãªã„ãŸã‚ã€ è¿”ã‚Šå€¤ã‚’å‡ºåŠ›ã™ã‚‹ã“ã¨ã®ã¿ã—ã¦ã„ã¾ã™ã€‚

ãã®ä¸‹ã®`describe('burnNFT', function () { ...`ã«ç¶šããƒ†ã‚¹ãƒˆã§ã¯ã€ `burnNFT`ã®æŒ™å‹•ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ã€‚
`mintNFT`å¾Œã«`burnNFT`ã‚’å‘¼ã³å‡ºã—ã€NFTãŒãƒãƒ¼ãƒ³ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ã€‚

æœ€å¾Œã«`describe('getTokenOwners', function () { ...`ã«ç¶šããƒ†ã‚¹ãƒˆã§ã¯ã€ `getTokenOwners`ã®æŒ™å‹•ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ã€‚
`mintNFT`å¾Œã«`burnNFT`ã‚’å‘¼ã³å‡ºã—ã€NFTãŒãƒãƒ¼ãƒ³ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ã€‚

### â­ ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã—ã‚‡ã†

`contract`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç›´ä¸‹ã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

âš ï¸ è¿½åŠ ã—ãŸãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã§ã¯ãƒ†ã‚¹ãƒˆãƒ˜ãƒ«ãƒ‘ãƒ¼ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®timeã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚
timeã®ä½¿ç”¨ã¯ãƒ†ã‚¹ãƒˆç’°å¢ƒå…¨ä½“ã®æ™‚é–“ã«å½±éŸ¿ã™ã‚‹ãŸã‚ã€ ä»Šå¾Œè¤‡æ•°ã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’åŒæ™‚ã«ãƒ†ã‚¹ãƒˆã™ã‚‹ã¨äºˆæœŸã›ã¬æŒ™å‹•ã‚’èµ·ã“ã™å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ã‚ˆã£ã¦ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ã¯ãƒ†ã‚¹ãƒˆã‚’ã™ã‚‹å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¼•æ•°ã«ã‚ˆã£ã¦æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚

```
$ npx hardhat test test/FarmNft.ts
```

ä»¥ä¸‹ã®ã‚ˆã†ãªè¡¨ç¤ºãŒã•ã‚Œã¾ã™ã€‚
å®Ÿè¡Œã—ãŸãƒ†ã‚¹ãƒˆåã¨ãã®ãƒ†ã‚¹ãƒˆãŒãƒ‘ã‚¹ã—ãŸã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

![](/public/images/AVAX-Asset-Tokenization/section-1/1_1_3.png)

### ğŸŒ” å‚è€ƒãƒªãƒ³ã‚¯

> [ã“ã¡ã‚‰](https://github.com/unchain-dev/AVAX-Asset-Tokenization)ã«æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å®Œæˆå½¢ã®ãƒ¬ãƒã‚¸ãƒˆãƒªãŒã‚ã‚Šã¾ã™ã€‚
> æœŸå¾…é€šã‚Šå‹•ã‹ãªã„å ´åˆã¯å‚è€ƒã«ã—ã¦ã¿ã¦ãã ã•ã„ã€‚

### ğŸ™‹â€â™‚ï¸ è³ªå•ã™ã‚‹

ã“ã“ã¾ã§ã®ä½œæ¥­ã§ä½•ã‹ã‚ã‹ã‚‰ãªã„ã“ã¨ãŒã‚ã‚‹å ´åˆã¯ã€Discordã®`#avalanche`ã§è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚

ãƒ˜ãƒ«ãƒ—ã‚’ã™ã‚‹ã¨ãã®ãƒ•ãƒ­ãƒ¼ãŒå††æ»‘ã«ãªã‚‹ã®ã§ã€ ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒãƒ¼ãƒˆã«ã¯ä¸‹è¨˜ã®3ç‚¹ã‚’è¨˜è¼‰ã—ã¦ãã ã•ã„ âœ¨

```
1. è³ªå•ãŒé–¢é€£ã—ã¦ã„ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç•ªå·ã¨ãƒ¬ãƒƒã‚¹ãƒ³ç•ªå·
2. ä½•ã‚’ã—ã‚ˆã†ã¨ã—ã¦ã„ãŸã‹
3. ã‚¨ãƒ©ãƒ¼æ–‡ã‚’ã‚³ãƒ”ãƒ¼&ãƒšãƒ¼ã‚¹ãƒˆ
4. ã‚¨ãƒ©ãƒ¼ç”»é¢ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
```

---

æ¬¡ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ã¯ã€ ã‚‚ã†1ã¤ã®ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ï¼
