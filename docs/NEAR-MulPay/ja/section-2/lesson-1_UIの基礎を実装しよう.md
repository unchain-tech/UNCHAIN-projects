### ğŸ¤˜ğŸ½ UI ã®åŸºç¤ã‚’ä½œæˆã—ã‚ˆã†

ã§ã¯ã“ã“ã‹ã‚‰ã¯ãƒ•ãƒ­ãƒ³ãƒˆå´ã‚’é–‹ç™ºã—ã¦ã„ãã¾ã™ã€‚ãŸã ã—ã€æœ¬ãƒ¬ãƒƒã‚¹ãƒ³ã¯ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ä½œæˆãŒãƒ¡ã‚¤ãƒ³ã®ã‚‚ã®ãªã®ã§ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®èª¬æ˜ã¨æ¯”ã¹ã¦èª¬æ˜ãŒå¤§ã¾ã‹ã«ãªã£ã¦ã„ã¾ã™ãŒã”äº†æ‰¿ãã ã•ã„ã€‚

ã¾ãšã¯ä½¿ç”¨ã™ã‚‹ç”»åƒã‚„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã—ã¦ã„ãã¾ã™ã€‚

ä¸€ç•ªä¸Šã®éšå±¤(`lib`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨åŒã˜éšå±¤)ã«`assets`, `smartcontracts`ã¨ã„ã†ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã—ã¾ã—ã‚‡ã†ã€‚

è¿½åŠ å¾Œã¯ä¸‹ã®ã‚ˆã†ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã«ãªã‚Šã¾ã™ã€‚

```
client/
â”œâ”€â”€ README.md
â”œâ”€â”€ analysis_options.yaml
â”œâ”€â”€ android/
â”œâ”€â”€ assets/
â”œâ”€â”€ build/
â”œâ”€â”€ ios/
â”œâ”€â”€ lib/
â”œâ”€â”€ linux/
â”œâ”€â”€ macos/
â”œâ”€â”€ package.json
â”œâ”€â”€ pubspec.lock
â”œâ”€â”€ pubspec.yaml
â”œâ”€â”€ smartcontracts/
â”œâ”€â”€ test/
â”œâ”€â”€ web/
â””â”€â”€ windows/
```

`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã¯éš ã—ãƒ•ã‚¡ã‚¤ãƒ«ã«ãªã£ã¦ã„ã‚‹ã®ã§è¡¨ç¤ºã¯ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯Gitã«ä¸Šã’ãªã„ãŸã‚ã«.gitignoreãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ ã—ã¦ãŠã„ã¦ãã ã•ã„ã€‚

æ¬¡ã«assetsãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æœ¬dappã«å¿…è¦ãªç”»åƒã‚’è¿½åŠ ã—ã¦ã„ãã¾ã™ã€‚ä»¥ä¸‹ã®ç”»åƒã‚’assetsãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚³ãƒ”ãƒ¼&ãƒšãƒ¼ã‚¹ãƒˆã—ã¦ãã ã•ã„ã€‚

[assets]

[MulPay_Icon_2_foreground.png]
![](/public/images/NEAR-MulPay/section-2/2_1_1.png)

[MulPay_Icon_2.png]
![](/public/images/NEAR-MulPay/section-2/2_1_2.png)

[aurora-aoa-logo.png]
![](/public/images/NEAR-MulPay/section-2/2_1_3.png)

[dai-dai-logo.png]
![](/public/images/NEAR-MulPay/section-2/2_1_4.png)

[ethereum-eth-logo.png]
![](/public/images/NEAR-MulPay/section-2/2_1_5.png)

[polygon-matic-logo.png]
![](/public/images/NEAR-MulPay/section-2/2_1_6.png)

[shib-logo.png]
![](/public/images/NEAR-MulPay/section-2/2_1_7.png)

[solana-sol-logo.png]
![](/public/images/NEAR-MulPay/section-2/2_1_8.png)

[tether-usdt-logo.png]
![](/public/images/NEAR-MulPay/section-2/2_1_9.png)

[uniswap-uni-logo.png]
![](/public/images/NEAR-MulPay/section-2/2_1_10.png)

[unchain_logo.png]
![](/public/images/NEAR-MulPay/section-2/2_1_11.png)

[multiple-coins.jpg]
![](/public/images/NEAR-MulPay/section-2/2_1_12.jpg)

[pop.svg]
![](/public/images/NEAR-MulPay/section-2/2_1_13.svg)

[pay.svg]
![](/public/images/NEAR-MulPay/section-2/2_1_14.svg)

[home.svg]
![](/public/images/NEAR-MulPay/section-2/2_1_15.svg)

[three-dots.svg]
![](/public/images/NEAR-MulPay/section-2/2_1_16.svg)

[triangle.svg]
![](/public/images/NEAR-MulPay/section-2/2_1_17.svg)

[wallet_screen_img.svg]
![](/public/images/NEAR-MulPay/section-2/2_1_18.svg)

[wallet.svg]
![](/public/images/NEAR-MulPay/section-2/2_1_19.svg)

æ¬¡ã«`smartcontracts`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«section-1ã§ä½œæˆã—ãŸã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®abiãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã—ã¾ã™ã€‚

MulPay-contractãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®`artifacts/contracts/`ã«ã‚ã‚‹ãã‚Œãã‚Œã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®abiãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼&ãƒšãƒ¼ã‚¹ãƒˆã—ã¾ã™ã€‚ä¾‹ãˆã°`ERC20Tokens.sol/AuraraToken.json`ãªã©ã§ã™ã€‚

å°‘ã—é¢å€’ã§ã™ãŒã€ã“ã‚Œã‚‰ã‚’ç”¨ã„ã¦ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã¨ã‚„ã‚Šã¨ã‚Šã‚’ã™ã‚‹ã®ã§å¿…è¦ãªéç¨‹ã§ã™ã€‚

smarcontractsãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸­èº«ã¯ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```
smartcontracts/
â”œâ”€â”€ AuroraToken.json
â”œâ”€â”€ DaiToken.json
â”œâ”€â”€ EthToken.json
â”œâ”€â”€ PolygonToken.json
â”œâ”€â”€ ShibainuToken.json
â”œâ”€â”€ SolanaToken.json
â”œâ”€â”€ SwapContract.json
â”œâ”€â”€ TetherToken.json
â””â”€â”€ UniswapToken.json
```

æ¬¡ã«ã“ã‚Œã‚‰ã®ä½¿ç”¨ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ç”»åƒãŒã‚ã‚‹ã“ã¨ã‚’å®£è¨€ã—ã¦ã„ãã¾ã™ã€‚

flutterã§ã¯`pubspec.yaml`ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã«å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚„ä½¿ç”¨ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¨˜è¿°ã—ã¾ã™ã€‚

ä¸‹ã®ã‚ˆã†ã«`pubspec.yaml`ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­ã®`dependencies:`ç›´ä¸‹ã‚’ä¸‹ã®ã‚ˆã†ã«æ›¸ãæ›ãˆã¾ã—ã‚‡ã†ã€‚

ã“ã“ã§æ³¨æ„ãªã®ãŒã€`pubspec.yaml`ãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ã‚¹ãƒšãƒ¼ã‚¹ãŒä¸€è¡Œã§ã‚‚ãšã‚Œã¦ã—ã¾ã†ã¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒä½¿ç”¨ã§ããªããªã‚‹ã®ã§ãã“ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

ãªã®ã§UIã‚’ä½œæˆã—ã¦ã„ã‚‹ã¨ãã«ã‚¨ãƒ©ãƒ¼ãŒã§ãŸéš›ã¯`pubspec.yaml`ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¿°ã—ã¦ã„ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒæ­£ã—ã„ã‚¹ãƒšãƒ¼ã‚¹ã§è¨˜è¿°ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ãªãŒã‚‰è¡Œã£ã¦ãã ã•ã„ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§è¨˜è¿°ã—ã¦ã‚ã‚‹é€šã‚Šã®ã‚¹ãƒšãƒ¼ã‚¹ã§è¨˜è¿°ã§ãã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ã¦ã„ããªãŒã‚‰è¡Œã£ã¦ã„ã‘ã°OKã§ã™ï¼

[`pubspec.yaml`]

```
dependencies:
  flutter:
    sdk: flutter

  # The following adds the Cupertino Icons font to your application.
  # Use with the CupertinoIcons class for iOS style icons.
  cupertino_icons: 1.0.6
  dropdown_button2: 1.9.4
  fluid_bottom_nav_bar: 1.3.0
  flutter_dotenv: 5.1.0
  flutter_svg: 0.22.0
  fluttertoast: 8.2.2
  google_fonts: 4.0.4
  hexcolor: 3.0.1
  http: 0.13.6
  provider: 6.0.5
  qr_code_scanner: 1.0.0
  qr_flutter: 4.1.0
  responsive_framework: 1.1.1
  url_launcher: 6.2.1
  walletconnect_flutter_v2: 2.1.8
  web_socket_channel: 2.4.0
  web3dart: 2.6.1
```

æ¬¡ã«ä½¿ç”¨ã™ã‚‹ç”»åƒã‚„ãƒ•ã‚¡ã‚¤ãƒ«ã®å®£è¨€ã€ã‚¢ã‚¤ã‚³ãƒ³ã‚’å¤‰æ›´ã™ã‚‹ãŸã‚ã®è¨˜è¿°ã‚’ã—ã¦ã„ãã¾ã™ã€‚å…ˆã»ã©ã®è¨˜è¿°ã®ä¸‹ã«æ›¸ã„ã¦ã‚ã‚‹ã‚‚ã®ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãæ›ãˆã¾ã—ã‚‡ã†ã€‚

[`pubspec.yaml`]

```yaml
dev_dependencies:
  flutter_test:
    sdk: flutter
  flutter_launcher_icons: ^0.10.0

flutter_icons:
  android: true
  ios: true
  image_path: "assets/MulPay_Icon_2.png"
  adaptive_icon_background: "#ffffff"
  adaptive_icon_foreground: "assets/MulPay_Icon_2_foreground.png"
  # The "flutter_lints" package below contains a set of recommended lints to
  # encourage good coding practices. The lint set provided by the package is
  # activated in the `analysis_options.yaml` file located at the root of your
  # package. See that file for information about deactivating specific lint
  # rules and activating additional ones.
  flutter_lints: ^2.0.0

flutter:
  # The following line ensures that the Material Icons font is
  # included with your application, so that you can use the icons in
  # the material Icons class.
  uses-material-design: true

  # To add assets to your application, add an assets section, like this:
  assets:
    - assets/
    - .env
    - smartcontracts/
```

ã‚¹ãƒšãƒ¼ã‚¹ã«ã¤ã„ã¦ã¯ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã‚Œã°OKã§ã™ã€‚
![](/public/images/NEAR-MulPay/section-2/2_1_20.png)
![](/public/images/NEAR-MulPay/section-2/2_1_21.png)

ãã®å¾Œã€`client`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã—ã¦ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§å®Ÿè¡Œã—ã¾ã—ã‚‡ã†ã€‚

```
flutter pub get
flutter pub run flutter_launcher_icons:main
```

æœ€å¾Œã«ä¸‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚Œã°æˆåŠŸã§ã™ï¼

```
âœ“ Successfully generated launcher icons
```

ã“ã‚Œã§ç”»åƒã‚„ãƒ•ã‚¡ã‚¤ãƒ«ã®å®£è¨€ã€ã‚¢ã‚¤ã‚³ãƒ³ã‚’å¤‰æ›´ã®ãŸã‚ã®è¨˜è¿°ã¯å®Œäº†ã—ã¾ã—ãŸï¼

ã§ã¯ã“ã“ã‹ã‚‰ã¯ã„ã‚ˆã„ã‚ˆUIã‚’ä½œæˆã—ã¦ã„ãã¾ã™ã€‚

ã¾ãšã¯deployã—ãŸã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚„ãã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®åå‰ã‚’.envãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

[`.env`]

```
SWAP_CONTRACT_ADDRESS = "0xC678d76a12Dd7f87FF1f952B6bEEd2c0fd308CF8"
AOA_CONTRACT_ADDRESS = "0x10E9C13e9f73A35d4a0C8AA8328b84EF9747b7a8"
DAI_CONTRACT_ADDRESS = "0x48a6b4beAeB3a959Cd358e3365fc9d178eB0B2D9"
ETH_CONTRACT_ADDRESS = "0x395A1065eA907Ab366807d68bbe21Df83169bA6c"
MATIC_CONTRACT_ADDRESS = "0x4A8c0C9f9f2444197cE78b672F0D98D1Fe47bdA6"
SHIB_CONTRACT_ADDRESS = "0xa11e679EE578B32d12Dbe2882FcC387A86C8f887"
SOL_CONTRACT_ADDRESS = "0x30E198301969fDeddDCb84cE2C284dF58d4AB944"
UNI_CONTRACT_ADDRESS = "0xC73F7cBD464aC7163D03dE669dedc3d1fA6Af5E4"
USDT_CONTRACT_ADDRESS = "0x44734B834364c37d35e6E4253779e9459c93B5F4"

SWAP_CONTRACT_NAME = "SwapContract"
AOA_CONTRACT_NAME = "AuroraToken"
DAI_CONTRACT_NAME = "DaiToken"
ETH_CONTRACT_NAME = "EthToken"
MATIC_CONTRACT_NAME = "PolygonToken"
SHIB_CONTRACT_NAME = "ShibainuToken"
SOL_CONTRACT_NAME = "SolanaToken"
UNI_CONTRACT_NAME = "UniswapToken"
USDT_CONTRACT_NAME = "TetherToken"

AURORA_TESTNET_INFURA_KEY = "Infura's aurora testnet http key"

WALLETCONNECT_PROJECT_ID = "WalletConnect's project id"
```

`XXX_CONTRACT_ADDRESS`ã«ã¯section-1ã®lesson-2ã§è¡Œã£ãŸdeployã‹ã‚‰è¿”ã£ã¦ããŸãã‚Œãã‚Œã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥ã‚Œã¾ã™ã€‚

`AURORA_TESTNET_INFURA_KEY`ã«ã¯section-0ã®lesson-2ã§è¡Œã£ãŸç’°å¢ƒæ§‹ç¯‰æ™‚ã«ä½œæˆã—ãŸinfuraã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã€aurora testnetç”¨ã®http keyã‚’å…¥ã‚Œã¾ã™ã€‚ä¸‹ã®ã‚ˆã†ãªå½¢å¼ã«ãªã£ã¦ã„ã‚‹ã‚‚ã®ã§ã™ã€‚

```
INFURA_KEY_TEST = "https://aurora-testnet.infura.io/v3/4b5...."
```

`WALLETCONNECT_PROJECT_ID`ã«ã¯åŒã˜ãsection-0ã®lesson-2ã§ä½œæˆã—ãŸWalletConnectã®project idã‚’å…¥ã‚Œã¾ã™ã€‚

ã§ã¯ã„ã‚ˆã„ã‚ˆåŸºç¤ã¨ãªã‚‹modelã‚„ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã‚’ä½œæˆã—ã¦ã„ããŸã„ã¨ã“ã‚ã§ã™ãŒã€ãã®å‰ã«ãƒ›ãƒ¼ãƒ ç”»é¢ãªã©ã®ãã‚Œãã‚Œã®ç”»é¢ã‚’ç°¡å˜ã«ä½œã£ã¦ãŠãã¾ã™ã€‚

æœ€çµ‚çš„ã«ã¯ç”»é¢é·ç§»ã‚’æƒ³å®šã—ã¦ä½œã‚‹ã®ã§ã€ãã®é·ç§»å…ˆãŒãªã‘ã‚Œã°ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã—ã¾ã„å‹•ã‹ãªã„ã¨ã„ã†äº‹æ…‹ãŒèµ·ãã‹ã­ãªã„ã®ã§ç°¡å˜ãªç”»é¢ã‚’ä½œã£ã¦ãŠãã¾ã™ã€‚

`lib/view/screens/`ã«ã‚ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã«ãã‚Œãã‚Œä»¥ä¸‹ã®ã‚ˆã†ã«ã‚³ãƒ¼ãƒ‰ã‚’è¨˜è¿°ã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚

[`home.dart`]

```dart
import 'package:flutter/material.dart';

class Home extends StatefulWidget {
  const Home({Key? key}) : super(key: key);

  @override
  State<Home> createState() => _HomeState();
}

class _HomeState extends State<Home> {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text("Home Screen")),
    );
  }
}

```

[`qr_code_scan.dart`]

```dart
import 'package:flutter/material.dart';

class QRCodeScan extends StatefulWidget {
  const QRCodeScan({Key? key}) : super(key: key);

  @override
  State<QRCodeScan> createState() => _HomeState();
}

class _HomeState extends State<QRCodeScan> {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text("QRCodeScan Screen")),
    );
  }
}
```

[`send.dart`]

```dart
import 'package:flutter/material.dart';

class Send extends StatefulWidget {
  const Send({Key? key}) : super(key: key);

  @override
  State<Send> createState() => _HomeState();
}

class _HomeState extends State<Send> {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text("Send Screen")),
    );
  }
}
```

[`signin.dart`]

```dart
import 'package:flutter/material.dart';

class SignIn extends StatefulWidget {
  const SignIn({Key? key}) : super(key: key);

  @override
  State<SignIn> createState() => _HomeState();
}

class _HomeState extends State<SignIn> {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text("SignIn Screen")),
    );
  }
}
```

[`wallet.dart`]

```dart
import 'package:flutter/material.dart';

class Wallet extends StatefulWidget {
  const Wallet({Key? key}) : super(key: key);

  @override
  State<Wallet> createState() => _HomeState();
}

class _HomeState extends State<Wallet> {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text("Wallet Screen")),
    );
  }
}
```

ã§ã¯modelã‚„ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã‚’ä½œæˆã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

`lib/model/contract_model.dart`ã«ç§»å‹•ã—ã¦ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã—ã‚‡ã†ã€‚

[`contract_model.dart`]

```dart
import 'dart:convert';
import 'dart:core';
import 'dart:math';

import 'package:flutter/material.dart';
import 'package:flutter/services.dart';
import 'package:flutter_dotenv/flutter_dotenv.dart';
import 'package:http/http.dart';
import 'package:url_launcher/url_launcher_string.dart';
import 'package:walletconnect_flutter_v2/walletconnect_flutter_v2.dart';
import 'package:web3dart/crypto.dart';
import 'package:web3dart/web3dart.dart';

class ContractModel extends ChangeNotifier {
  List<Token> tokenList = [
    Token(
      address: dotenv.env["AOA_CONTRACT_ADDRESS"]!,
      contractName: dotenv.env["AOA_CONTRACT_NAME"]!,
      name: "Aurora",
      symbol: "AOA",
      imagePath: "assets/aurora-aoa-logo.png",
    ),
    Token(
        address: dotenv.env["DAI_CONTRACT_ADDRESS"]!,
        contractName: dotenv.env["DAI_CONTRACT_NAME"]!,
        name: "Dai",
        symbol: "DAI",
        imagePath: "assets/dai-dai-logo.png"),
    Token(
        address: dotenv.env["ETH_CONTRACT_ADDRESS"]!,
        contractName: dotenv.env["ETH_CONTRACT_NAME"]!,
        name: "Ethereum",
        symbol: "ETH",
        imagePath: "assets/ethereum-eth-logo.png"),
    Token(
        address: dotenv.env["MATIC_CONTRACT_ADDRESS"]!,
        contractName: dotenv.env["MATIC_CONTRACT_NAME"]!,
        name: "Polygon",
        symbol: "MATIC",
        imagePath: "assets/polygon-matic-logo.png"),
    Token(
        address: dotenv.env["SHIB_CONTRACT_ADDRESS"]!,
        contractName: dotenv.env["SHIB_CONTRACT_NAME"]!,
        name: "Shibainu",
        symbol: "SHIB",
        imagePath: "assets/shib-logo.png"),
    Token(
        address: dotenv.env["SOL_CONTRACT_ADDRESS"]!,
        contractName: dotenv.env["SOL_CONTRACT_NAME"]!,
        name: "Solana",
        symbol: "SOL",
        imagePath: "assets/solana-sol-logo.png"),
    Token(
        address: dotenv.env["UNI_CONTRACT_ADDRESS"]!,
        contractName: dotenv.env["UNI_CONTRACT_NAME"]!,
        name: "Uniswap",
        symbol: "UNI",
        imagePath: "assets/uniswap-uni-logo.png"),
    Token(
        address: dotenv.env["USDT_CONTRACT_ADDRESS"]!,
        contractName: dotenv.env["USDT_CONTRACT_NAME"]!,
        name: "Tether",
        symbol: "USDT",
        imagePath: "assets/tether-usdt-logo.png"),
  ];

  final SWAP_CONTRACT_ADDRESS = dotenv.env["SWAP_CONTRACT_ADDRESS"];
  final SWAP_CONTRACT_NAME = dotenv.env["SWAP_CONTRACT_NAME"];

  String? _deepLinkUrl;
  String? _account;
  Web3App? _wcClient;
  SessionData? _sessionData;

  late Web3Client auroraClient;
  int ethBalance = 0;

  DeployedContract? _contract;

  ContractModel() {
    init();
  }

  Future<void> init() async {
    var httpClient = Client();

    auroraClient =
        Web3Client(dotenv.env["AURORA_TESTNET_INFURA_KEY"]!, httpClient);
  }

  getAccount() {
    return _account;
  }

  Future<DeployedContract> getContract(
      String contractName, String contractAddress) async {
    String abi =
        await rootBundle.loadString('smartcontracts/$contractName.json');
    DeployedContract contract = DeployedContract(
      ContractAbi.fromJson(jsonEncode(jsonDecode(abi)["abi"]), contractName),
      EthereumAddress.fromHex(contractAddress),
    );
    return contract;
  }

  // This is called for read-only function of contract
  Future<List<dynamic>> query(String contractName, String contractAddress,
      String functionName, List<dynamic> args) async {
    DeployedContract contract =
        await getContract(contractName, contractAddress);
    ContractFunction function = contract.function(functionName);
    List<dynamic> result = await auroraClient.call(
      contract: contract,
      function: function,
      params: args,
    );
    return result;
  }

  Future<EthereumTransaction> generateTransaction(
      String contractName,
      String contractAddress,
      String functionName,
      List<dynamic> parameters) async {
    _contract = await getContract(contractName, contractAddress);

    ContractFunction function = _contract!.function(functionName);

    // web3dartã‚’ä½¿ç”¨ã—ã¦ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã™ã€‚
    final Transaction transaction = Transaction.callContract(
        contract: _contract!, function: function, parameters: parameters);

    // walletconnect_flutter_v2ã‚’ä½¿ç”¨ã—ã¦ã€Ethereumãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã™ã€‚
    final EthereumTransaction ethereumTransaction = EthereumTransaction(
      from: _account!,
      to: contractAddress,
      value: '0x${transaction.value?.getInWei.toRadixString(16) ?? '0'}',
      data: transaction.data != null ? bytesToHex(transaction.data!) : null,
    );

    return ethereumTransaction;
  }

  Future<String> sendTransaction(EthereumTransaction transaction) async {
    // Metamaskã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èµ·å‹•ã—ã¾ã™ã€‚
    await launchUrlString(_deepLinkUrl!, mode: LaunchMode.externalApplication);

    // ç½²åã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ã¾ã™ã€‚
    final String signResponse = await _wcClient?.request(
      topic: _sessionData?.topic ?? "",
      chainId: 'eip155:1313161555',
      request: SessionRequestParams(
        method: 'eth_sendTransaction',
        params: [transaction.toJson()],
      ),
    );

    return signResponse;
  }

  Future<void> setConnection(
      String deepLinkUrl, Web3App wcClient, SessionData sessionData) async {
    _deepLinkUrl = deepLinkUrl;
    _wcClient = wcClient;
    _sessionData = sessionData;
    // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’èªè¨¼ã—ãŸã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å–å¾—ã—ã¾ã™ã€‚
    _account = NamespaceUtils.getAccount(
        sessionData.namespaces.values.first.accounts.first);

    notifyListeners();
  }

  Future<String> getBalance(
      String tokenContractName, String tokenAddress) async {
    List<dynamic> result = await query(tokenContractName, tokenAddress,
        'balanceOf', [EthereumAddress.fromHex(_account!)]);
    return result[0].toString();
  }

  Future<String> getEthBalance(String tokenContractName) async {
    List<dynamic> result = await query(
        SWAP_CONTRACT_NAME!, SWAP_CONTRACT_ADDRESS!, 'calculateValue', [
      EthereumAddress.fromHex(dotenv.env["ETH_CONTRACT_ADDRESS"]!),
      EthereumAddress.fromHex(tokenContractName)
    ]);
    return result[0].toString();
  }

  Future<bool> getTokensInfo() async {
    for (int i = 0; i < tokenList.length; i++) {
      final balance =
          await getBalance(tokenList[i].contractName, tokenList[i].address);
      final ethValue = await getEthBalance(tokenList[i].address);
      final ethBalance =
          ((double.parse(ethValue) * double.parse(balance) / (pow(10, 18)))
                  .ceil())
              .toString();
      tokenList[i]
        ..balance = balance
        ..ethBalance = ethBalance;
    }
    return true;
  }

  Future<void> sendToken(String sendTokenContractName, String sendTokenAddress,
      String receiveTokenAddress, String recipientAddress, int amount) async {
    try {
      // ãƒˆãƒ¼ã‚¯ãƒ³ã®é€ä¿¡ã‚’æ‰¿èªã—ã¾ã™ã€‚
      final EthereumTransaction ethereumTransactionOfApprove =
          await generateTransaction(
              sendTokenContractName, sendTokenAddress, "approve", [
        EthereumAddress.fromHex(dotenv.env['SWAP_CONTRACT_ADDRESS']!),
        BigInt.from(amount),
      ]);

      final String signResponseOfApprove =
          await sendTransaction(ethereumTransactionOfApprove);
      debugPrint('=== signResponseOfApprove: $signResponseOfApprove');

      final EthereumTransaction ethereumTransactionOfSwap =
          await generateTransaction(
        dotenv.env['SWAP_CONTRACT_NAME']!,
        dotenv.env['SWAP_CONTRACT_ADDRESS']!,
        "swap",
        [
          // measureToken is got rid of
          EthereumAddress.fromHex(sendTokenAddress),
          EthereumAddress.fromHex(sendTokenAddress),
          EthereumAddress.fromHex(receiveTokenAddress),
          BigInt.from(amount),
          EthereumAddress.fromHex(recipientAddress),
        ],
      );

      final String signResponseOfSwap =
          await sendTransaction(ethereumTransactionOfSwap);
      debugPrint('=== signResponseOfSwap: $signResponseOfSwap');
    } catch (error) {
      rethrow;
    } finally {
      notifyListeners();
    }
  }

  Future<void> distributeToken(String tokenAddress) async {
    try {
      final EthereumTransaction ethereumTransaction = await generateTransaction(
        dotenv.env["SWAP_CONTRACT_NAME"]!,
        dotenv.env["SWAP_CONTRACT_ADDRESS"]!,
        "distributeToken",
        [
          EthereumAddress.fromHex(tokenAddress),
          BigInt.from(100),
          EthereumAddress.fromHex(_account!),
        ],
      );

      final String signResponse = await sendTransaction(ethereumTransaction);
      debugPrint('=== signResponse: $signResponse');
    } catch (error) {
      rethrow;
    } finally {
      notifyListeners();
    }
  }

  Future<double> getTotalBalance() async {
    double total = 0;
    for (int i = 0; i < tokenList.length; i++) {
      var balance =
          await getBalance(tokenList[i].contractName, tokenList[i].address);
      var ethValue = await getEthBalance(tokenList[i].address);
      var ethBalance =
          ((double.parse(ethValue) * double.parse(balance) / (pow(10, 18)))
                  .ceil())
              .toString();
      total += double.parse(ethBalance);
    }
    return total;
  }
}

class Token {
  final String address;
  final String contractName;
  final String name;
  final String symbol;
  final String imagePath;
  String? balance;
  String? ethBalance;

  Token({
    required this.address,
    required this.contractName,
    required this.name,
    required this.symbol,
    required this.imagePath,
  }) {
    this.balance = "0";
    this.ethBalance = "0";
  }
}

// Ethereumãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®ãƒ¢ãƒ‡ãƒ«ã‚¯ãƒ©ã‚¹
class EthereumTransaction {
  const EthereumTransaction({
    required this.from,
    required this.to,
    required this.value,
    this.data,
  });

  final String from;
  final String to;
  final String value;
  final String? data;

  Map<String, dynamic> toJson() => {
        'from': from,
        'to': to,
        'value': value,
        'data': data,
      };
}

```

æœ€åˆã®`import`ã®éƒ¨åˆ†ã§å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å®£è¨€ã—ã¦ã„ã¾ã™ã€‚

```dart
import 'dart:convert';
import 'dart:core';
import 'dart:math';

import 'package:flutter/material.dart';
import 'package:flutter/services.dart';
import 'package:flutter_dotenv/flutter_dotenv.dart';
import 'package:http/http.dart';
import 'package:url_launcher/url_launcher_string.dart';
import 'package:web3_connect/web3_connect.dart';
import 'package:web3dart/web3dart.dart';
import 'package:web_socket_channel/io.dart';
import 'package:http/http.dart' as http;
```

æ¬¡ã®`ContractModel`ã®ä¸­ã«å¿…è¦ãªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚„ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å…¥ã‚Œã¦ã„ã¾ã™ã€‚

åºç›¤ã§ã¯ãã‚Œãã‚Œã®Tokenã«ã¤ã„ã¦ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚„ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®åå‰ãªã©ã‚’ãƒªã‚¹ãƒˆåŒ–ã—ãŸã‚‚ã®ã‚„Auroraä¸Šã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã¨ã‚„ã‚Šå–ã‚Šã™ã‚‹ãŸã‚ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å®£è¨€ã—ã¦ã„ã¾ã™ã€‚

```dart
class ContractModel extends ChangeNotifier {
  List<Token> tokenList = [
    Token(
      address: dotenv.env["AOA_CONTRACT_ADDRESS"]!,
      contractName: dotenv.env["AOA_CONTRACT_NAME"]!,
      name: "Aurora",
      symbol: "AOA",
      imagePath: "assets/aurora-aoa-logo.png",
    ),
    Token(
        address: dotenv.env["DAI_CONTRACT_ADDRESS"]!,
        contractName: dotenv.env["DAI_CONTRACT_NAME"]!,
        name: "Dai",
        symbol: "DAI",
        imagePath: "assets/dai-dai-logo.png"),
    Token(
        address: dotenv.env["ETH_CONTRACT_ADDRESS"]!,
        contractName: dotenv.env["ETH_CONTRACT_NAME"]!,
        name: "Ethereum",
        symbol: "ETH",
        imagePath: "assets/ethereum-eth-logo.png"),
    Token(
        address: dotenv.env["MATIC_CONTRACT_ADDRESS"]!,
        contractName: dotenv.env["MATIC_CONTRACT_NAME"]!,
        name: "Polygon",
        symbol: "MATIC",
        imagePath: "assets/polygon-matic-logo.png"),
    Token(
        address: dotenv.env["SHIB_CONTRACT_ADDRESS"]!,
        contractName: dotenv.env["SHIB_CONTRACT_NAME"]!,
        name: "Shibainu",
        symbol: "SHIB",
        imagePath: "assets/shib-logo.png"),
    Token(
        address: dotenv.env["SOL_CONTRACT_ADDRESS"]!,
        contractName: dotenv.env["SOL_CONTRACT_NAME"]!,
        name: "Solana",
        symbol: "SOL",
        imagePath: "assets/solana-sol-logo.png"),
    Token(
        address: dotenv.env["UNI_CONTRACT_ADDRESS"]!,
        contractName: dotenv.env["UNI_CONTRACT_NAME"]!,
        name: "Uniswap",
        symbol: "UNI",
        imagePath: "assets/uniswap-uni-logo.png"),
    Token(
        address: dotenv.env["USDT_CONTRACT_ADDRESS"]!,
        contractName: dotenv.env["USDT_CONTRACT_NAME"]!,
        name: "Tether",
        symbol: "USDT",
        imagePath: "assets/tether-usdt-logo.png"),
  ];

  final SWAP_CONTRACT_ADDRESS = dotenv.env["SWAP_CONTRACT_ADDRESS"];
  final SWAP_CONTRACT_NAME = dotenv.env["SWAP_CONTRACT_NAME"];

  String? _deepLinkUrl;
  String? _account;
  Web3App? _wcClient;
  SessionData? _sessionData;

  late Web3Client auroraClient;
  int ethBalance = 0;

  DeployedContract? _contract;
```

å¾ŒåŠã®éƒ¨åˆ†ã§ã¯ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã«ã‚ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™ãŸã‚ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒæ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚

æœ€åˆã«æ›¸ã„ã¦ã„ã‚‹`init`é–¢æ•°ã¯ã“ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆãŒä½œæˆã•ã‚ŒãŸæ™‚ã«æœ€åˆã«èµ°ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã§ã€infuraã‚’é€šã˜ã¦Auroraã®Testnetä¸Šã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã¨ã‚„ã‚Šã¨ã‚ŠãŒã§ãã‚‹ãŸã‚ã®æº–å‚™ã‚’ã—ã¦ã„ã¾ã™ã€‚

```dart
ContractModel() {
    init();
  }

  Future<void> init() async {
    var httpClient = Client();

    auroraClient =
        Web3Client(dotenv.env["AURORA_TESTNET_INFURA_KEY"]!, httpClient);
  }
```

ãã—ã¦`getContract`ãƒ¡ã‚½ãƒƒãƒ‰ã¯ãã‚Œãã‚Œã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®æƒ…å ±ã‚’å–å¾—ã—ã¦ã€ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã¶ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚

```dart
Future<DeployedContract> getContract(
    String contractName, String contractAddress) async {
  String abi =
      await rootBundle.loadString('smartcontracts/$contractName.json');
  DeployedContract contract = DeployedContract(
    ContractAbi.fromJson(jsonEncode(jsonDecode(abi)["abi"]), contractName),
    EthereumAddress.fromHex(contractAddress),
  );
  return contract;
}
```

`query`é–¢æ•°ã¯èª­ã¿å–ã‚Šå°‚ç”¨ã®é–¢æ•°ã‚’å‘¼ã¶éš›ã«ä½¿ã†ã‚‚ã®ã§ã™ã€‚ã“ã‚Œã¯walletã¨ã®ã‚„ã‚Šå–ã‚Šã‚’ã™ã‚‹å¿…è¦ï¼ˆwalletã®è¨±å¯ã‚’å¿…è¦ï¼‰ãŒãªã„é–¢æ•°ã«ä½¿ã‚ã‚Œã‚‹ã‚‚ã®ã§ã™ã€‚ã“ã®é–¢æ•°ã§ã¯ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³çŠ¶ã®å€¤ã‚’æ›¸ãæ›ãˆãŸã‚Šã€è¿½åŠ ã—ãŸã‚Šã™ã‚‹ã“ã¨ã¯ã§ãã›ã‚“ã€‚

```dart
Future<List<dynamic>> query(String contractName, String contractAddress,
    String functionName, List<dynamic> args) async {
  DeployedContract contract =
      await getContract(contractName, contractAddress);
  ContractFunction function = contract.function(functionName);
  List<dynamic> result = await auroraClient.call(
    contract: contract,
    function: function,
    params: args,
  );
  return result;
}
```

`generateTransaction`é–¢æ•°ã¯ã€ãã®æ¬¡ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹`sendTransaction`é–¢æ•°ã§ä½¿ç”¨ã™ã‚‹ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã™ã€‚`sendTransaction`é–¢æ•°ã¯ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ä¸Šã®å€¤ã‚’æ›¸ãæ›ãˆã‚‹ã‚ˆã†ãªé–¢æ•°ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚ãŸã ã—ã€æ¯å›walletã®è¨±å¯ãŒå¿…è¦ã¨ãªã‚Šã¾ã™ã€‚

```dart
Future<EthereumTransaction> generateTransaction(
    String contractName,
    String contractAddress,
    String functionName,
    List<dynamic> parameters) async {
  _contract = await getContract(contractName, contractAddress);

  ContractFunction function = _contract!.function(functionName);

  // web3dartã‚’ä½¿ç”¨ã—ã¦ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã™ã€‚
  final Transaction transaction = Transaction.callContract(
      contract: _contract!, function: function, parameters: parameters);

  // walletconnect_flutter_v2ã‚’ä½¿ç”¨ã—ã¦ã€Ethereumãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã™ã€‚
  final EthereumTransaction ethereumTransaction = EthereumTransaction(
    from: _account!,
    to: contractAddress,
    value: '0x${transaction.value?.getInWei.toRadixString(16) ?? '0'}',
    data: transaction.data != null ? bytesToHex(transaction.data!) : null,
  );

  return ethereumTransaction;
}

Future<String> sendTransaction(EthereumTransaction transaction) async {
  // Metamaskã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èµ·å‹•ã—ã¾ã™ã€‚
  await launchUrlString(_deepLinkUrl!, mode: LaunchMode.externalApplication);

  // ç½²åã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ã¾ã™ã€‚
  final String signResponse = await _wcClient?.request(
    topic: _sessionData?.topic ?? "",
    chainId: 'eip155:1313161555',
    request: SessionRequestParams(
      method: 'eth_sendTransaction',
      params: [transaction.toJson()],
    ),
  );

  return signResponse;
}
```

`setConnection`é–¢æ•°ã¯walletã¨æ¥ç¶šã—ãŸæƒ…å ±ã‚’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã—ãŸã“ã®modelã«ä¿å­˜ã™ã‚‹ãŸã‚ã®é–¢æ•°ã§ã™ã€‚

```dart
Future<void> setConnection(
    String deepLinkUrl, Web3App wcClient, SessionData sessionData) async {
  _deepLinkUrl = deepLinkUrl;
  _wcClient = wcClient;
  _sessionData = sessionData;
  // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’èªè¨¼ã—ãŸã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å–å¾—ã—ã¾ã™ã€‚
  _account = NamespaceUtils.getAccount(
      sessionData.namespaces.values.first.accounts.first);

  notifyListeners();
}
```

ãã‚Œä»¥é™ã¯ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã«å­˜åœ¨ã™ã‚‹é–¢æ•°ã‚’å‘¼ã³å‡ºã™ã‚‚ã®ã§ã€æŒ‡å®šã®ãƒˆãƒ¼ã‚¯ãƒ³ã®æ®‹é«˜ã‚’å‚ç…§ã—ãŸã‚Šã€swapã‚’è¡Œã†ãªã©section-1ã§ä½œæˆã—ãŸé–¢æ•°ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚

```dart
Future<String> getBalance(
    String tokenContractName, String tokenAddress) async {
  List<dynamic> result = await query(tokenContractName, tokenAddress,
      'balanceOf', [EthereumAddress.fromHex(_account!)]);
  return result[0].toString();
}

Future<String> getEthBalance(String tokenContractName) async {
  List<dynamic> result = await query(
      SWAP_CONTRACT_NAME!, SWAP_CONTRACT_ADDRESS!, 'calculateValue', [
    EthereumAddress.fromHex(dotenv.env["ETH_CONTRACT_ADDRESS"]!),
    EthereumAddress.fromHex(tokenContractName)
  ]);
  return result[0].toString();
}

Future<bool> getTokensInfo() async {
  for (int i = 0; i < tokenList.length; i++) {
    final balance =
        await getBalance(tokenList[i].contractName, tokenList[i].address);
    final ethValue = await getEthBalance(tokenList[i].address);
    final ethBalance =
        ((double.parse(ethValue) * double.parse(balance) / (pow(10, 18)))
                .ceil())
            .toString();
    tokenList[i]
      ..balance = balance
      ..ethBalance = ethBalance;
  }
  return true;
}

Future<void> sendToken(String sendTokenContractName, String sendTokenAddress,
    String receiveTokenAddress, String recipientAddress, int amount) async {
  try {
    // ãƒˆãƒ¼ã‚¯ãƒ³ã®é€ä¿¡ã‚’æ‰¿èªã—ã¾ã™ã€‚
    final EthereumTransaction ethereumTransactionOfApprove =
        await generateTransaction(
            sendTokenContractName, sendTokenAddress, "approve", [
      EthereumAddress.fromHex(dotenv.env['SWAP_CONTRACT_ADDRESS']!),
      BigInt.from(amount),
    ]);

    final String signResponseOfApprove =
        await sendTransaction(ethereumTransactionOfApprove);
    debugPrint('=== signResponseOfApprove: $signResponseOfApprove');

    final EthereumTransaction ethereumTransactionOfSwap =
        await generateTransaction(
      dotenv.env['SWAP_CONTRACT_NAME']!,
      dotenv.env['SWAP_CONTRACT_ADDRESS']!,
      "swap",
      [
        // measureToken is got rid of
        EthereumAddress.fromHex(sendTokenAddress),
        EthereumAddress.fromHex(sendTokenAddress),
        EthereumAddress.fromHex(receiveTokenAddress),
        BigInt.from(amount),
        EthereumAddress.fromHex(recipientAddress),
      ],
    );

    final String signResponseOfSwap =
        await sendTransaction(ethereumTransactionOfSwap);
    debugPrint('=== signResponseOfSwap: $signResponseOfSwap');
  } catch (error) {
    rethrow;
  } finally {
    notifyListeners();
  }
}

Future<void> distributeToken(String tokenAddress) async {
  try {
    final EthereumTransaction ethereumTransaction = await generateTransaction(
      dotenv.env["SWAP_CONTRACT_NAME"]!,
      dotenv.env["SWAP_CONTRACT_ADDRESS"]!,
      "distributeToken",
      [
        EthereumAddress.fromHex(tokenAddress),
        BigInt.from(100),
        EthereumAddress.fromHex(_account!),
      ],
    );

    final String signResponse = await sendTransaction(ethereumTransaction);
    debugPrint('=== signResponse: $signResponse');
  } catch (error) {
    rethrow;
  } finally {
    notifyListeners();
  }
}

Future<double> getTotalBalance() async {
  double total = 0;
  for (int i = 0; i < tokenList.length; i++) {
    var balance =
        await getBalance(tokenList[i].contractName, tokenList[i].address);
    var ethValue = await getEthBalance(tokenList[i].address);
    var ethBalance =
        ((double.parse(ethValue) * double.parse(balance) / (pow(10, 18)))
                .ceil())
            .toString();
    total += double.parse(ethBalance);
  }
  return total;
}
```

ä¸€ç•ªä¸‹ã«ã¯classã‚’å®šç¾©ã—ã¦ã„ã¾ã™ã€‚`Token`ã¨ã„ã†ã‚¯ãƒ©ã‚¹ã¯ãƒˆãƒ¼ã‚¯ãƒ³ã®æƒ…å ±ã‚’ä¿å­˜ã™ã‚‹ãŸã‚ã®classã«ãªã‚Šã¾ã™ã€‚`EthereumTransaction`ã¨ã„ã†ã‚¯ãƒ©ã‚¹ã¯ã€walletconnect_flutter_v2ã‚’ä½¿ç”¨ã—ã¦Ethereumãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®classã«ãªã‚Šã¾ã™ã€‚

```dart
class Token {
  final String address;
  final String contractName;
  final String name;
  final String symbol;
  final String imagePath;
  String? balance;
  String? ethBalance;

  Token({
    required this.address,
    required this.contractName,
    required this.name,
    required this.symbol,
    required this.imagePath,
  }) {
    this.balance = "0";
    this.ethBalance = "0";
  }
}

// Ethereumãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®ãƒ¢ãƒ‡ãƒ«ã‚¯ãƒ©ã‚¹
class EthereumTransaction {
  const EthereumTransaction({
    required this.from,
    required this.to,
    required this.value,
    this.data,
  });

  final String from;
  final String to;
  final String value;
  final String? data;

  Map<String, dynamic> toJson() => {
        'from': from,
        'to': to,
        'value': value,
        'data': data,
      };
}s
```

ã§ã¯æ¬¡ã«homeç”»é¢ã«è¡¨ç¤ºã™ã‚‹ã€ãã‚Œãã‚Œã®ã‚³ã‚¤ãƒ³ã®æ®‹é«˜æƒ…å ±ã‚’ç¤ºã™ãƒªã‚¹ãƒˆä¸€ã¤ä¸€ã¤ã®å…ƒã¨ãªã‚‹UIã‚’ä½œæˆã—ã¦ã„ãã¾ã™ã€‚

![](/public/images/NEAR-MulPay/section-2/2_1_22.png)

`lib/view/widgets/coin.dart`ã«ç§»å‹•ã—ã¦ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

[`coin.dart`]

```dart
import 'package:flutter/material.dart';
import 'package:hexcolor/hexcolor.dart';

Widget Coins(double displayWidth, displayHeight, String imagePath, symbol, name,
    depo, value, bool isDeskTop) {
  return Container(
    height: displayHeight * 0.08,
    width: displayWidth,
    padding: const EdgeInsets.symmetric(horizontal: 10),
    margin: EdgeInsets.symmetric(vertical: displayHeight * 0.008),
    decoration: BoxDecoration(
      borderRadius: const BorderRadius.all(
        Radius.circular(20),
      ),
      color: HexColor('#054C74'),
    ),
    child: Row(
      children: [
        Row(
          children: [
            SizedBox(
              height: isDeskTop ? 55 : 37,
              width: isDeskTop ? 55 : 37,
              child: Image.asset(imagePath),
            ),
            const SizedBox(
              width: 13,
            ),
            Column(
              mainAxisAlignment: MainAxisAlignment.center,
              crossAxisAlignment: CrossAxisAlignment.start,
              children: [
                Text(
                  symbol,
                  style: TextStyle(
                    fontWeight: FontWeight.bold,
                    color: Colors.white,
                    fontSize: isDeskTop ? 20 : 14,
                  ),
                ),
                Text(
                  name,
                  style: TextStyle(
                    fontWeight: FontWeight.bold,
                    color: Colors.grey,
                    fontSize: isDeskTop ? 17 : 12,
                  ),
                ),
              ],
            ),
          ],
        ),
        const Expanded(
          child: SizedBox(),
        ),
        SizedBox(
          width: displayWidth * 0.18,
          child: Column(
            mainAxisAlignment: MainAxisAlignment.center,
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              Text(
                '$depo $symbol',
                style: TextStyle(
                  color: Colors.white,
                  fontSize: isDeskTop ? 20 : 13,
                ),
              ),
              Text(
                '$value ETH',
                style: TextStyle(
                  fontWeight: FontWeight.bold,
                  color: Colors.white,
                  fontSize: isDeskTop ? 18 : 12,
                ),
              ),
            ],
          ),
        ),
      ],
    ),
  );
}
```

ã“ã‚Œã§ãã‚Œãã‚Œã®ãƒˆãƒ¼ã‚¯ãƒ³ã«ã¤ã„ã¦ã€ãƒ­ã‚´ã‚„åå‰ã€æ®‹é«˜ã¨ETHæ›ç®—ã—ãŸæ™‚ã®ä¾¡å€¤ã‚’è¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼

æœ€åˆã®ç’°å¢ƒæ§‹ç¯‰ã§ã€ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã¨webã®ã©ã¡ã‚‰ã®ã§ã‚‚å‹•ä½œã™ã‚‹ã¨èª¬æ˜ã—ã¾ã—ãŸã­ã€‚flutterã§ã¯å‹•ä½œã¯ã™ã‚‹ã®ã§ã™ãŒãã‚Œã‚’UIã«ã‚‚åæ˜ ã•ã›ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ãã“ã§å¼•æ•°ã¨ã—ã¦å—ã‘å–ã£ã¦ã„ã‚‹`isDeskTop`ã§ã€ã“ã®ã‚¢ãƒ—ãƒªãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ãƒ‡ãƒã‚¤ã‚¹ã®ç”»é¢ãŒãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã®ç”»é¢ãªã®ã‹ã€ãƒ¢ãƒã‚¤ãƒ«ã®ç”»é¢ãªã®ã‹ã‚’ã“ã¡ã‚‰ã®ã‚³ãƒ¼ãƒ‰ã§åˆ¤å®šã—ã¦ã„ã¾ã™ã€‚

ã“ã®å€¤ã‚’ã‚‚ã¨ã«ä¾‹ãˆã°ã—ãŸã®ã‚ˆã†ã«ãƒˆãƒ¼ã‚¯ãƒ³ã®ãƒ­ã‚´ã®å¤§ãã•ãŒå¤‰ã‚ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

```dart
SizedBox(
              height: isDeskTop ? 55 : 37,
              width: isDeskTop ? 55 : 37,
              child: Image.asset(imagePath),
            ),
```

ã“ã®`isDesktop`ã¯æ¬¡ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®`main.dart`ã§è¨˜è¿°ã•ã‚Œã¦ã„ã‚‹éƒ¨åˆ†ã§å€¤ã‚’å–å¾—ã—ã¦ã€æ§˜ã€…ãªç”»é¢ã§ä½¿ç”¨ã™ã‚‹ã“ã¨ã¨ãªã‚Šã¾ã™ã€‚

æ¬¡ã«ä¸‹ã«ç½®ããƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã®å®Ÿè£…ã‚’è¡Œãªã£ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

ä»Šå›ã¯å‹•ãã®ã‚ã‚‹ã‚‚ã®ã‚’ä½œæˆã—ã¦ã„ã“ã†ã¨æ€ã†ã®ã§`fluid_bottom_nav_bar`ã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

ã§ã¯`lib/view/widgets/navbar.dart`ã¸ç§»å‹•ã—ã¦ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã—ã‚‡ã†ã€‚

[`navbar.dart`]

```dart
import 'package:fluid_bottom_nav_bar/fluid_bottom_nav_bar.dart';
import 'package:flutter/material.dart';
import 'package:hexcolor/hexcolor.dart';
import 'package:provider/provider.dart';

import '/view/screens/home.dart';
import '/view/screens/send.dart';
import '/view/screens/wallet.dart';

class BottomNavigationBarProvider with ChangeNotifier {
  int _currentIndex = 0;

  int get currentIndex => _currentIndex;

  set currentIndex(int index) {
    _currentIndex = index;
    notifyListeners();
  }
}

class BottomNavigationBarWidget extends StatefulWidget {
  const BottomNavigationBarWidget({Key? key}) : super(key: key);

  @override
  State<BottomNavigationBarWidget> createState() => _BottomNavigationBarState();
}

class _BottomNavigationBarState extends State<BottomNavigationBarWidget> {
  var currentTab = [
    const Home(),
    const Send(),
    const Wallet(),
  ];

  @override
  Widget build(BuildContext context) {
    var provider = Provider.of<BottomNavigationBarProvider>(context);
    return Scaffold(
      body: currentTab[provider.currentIndex],
      bottomNavigationBar: FluidNavBar(
        icons: [
          FluidNavBarIcon(
            svgPath: "assets/home.svg",
            extras: {"label": "home"},
            backgroundColor:
                provider.currentIndex == 0 ? HexColor("#0C9DB0") : Colors.black,
          ),
          FluidNavBarIcon(
            svgPath: "assets/pay.svg",
            extras: {"label": "send"},
            backgroundColor:
                provider.currentIndex == 1 ? HexColor("#0C9DB0") : Colors.black,
          ),
          FluidNavBarIcon(
            svgPath: "assets/wallet.svg",
            extras: {"label": "wallet"},
            backgroundColor:
                provider.currentIndex == 2 ? HexColor("#0C9DB0") : Colors.black,
          )
        ],
        onChange: (index) => {
          provider.currentIndex = index,
        },
        style: const FluidNavBarStyle(
          iconUnselectedForegroundColor: Colors.grey,
          iconSelectedForegroundColor: Colors.white,
          barBackgroundColor: Colors.black,
        ),
        scaleFactor: 5,
        defaultIndex: 0,
        itemBuilder: (icon, item) => Semantics(
          label: icon.extras!["label"],
          child: item,
        ),
        animationFactor: 0.7,
      ),
    );
  }
}

```

æœ€åˆã®éƒ¨åˆ†ã§ã¯ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã§ä½¿ç”¨ã™ã‚‹ã‚¯ãƒ©ã‚¹ã‚’å®£è¨€ã—ã¦ã„ã¾ã™ã€‚ã“ã®ã‚¯ãƒ©ã‚¹ã«ã‚ˆã£ã¦ä»Šã©ã“ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é¸æŠã—ã¦ã„ã‚‹ã®ã‹ã‚’ç®¡ç†ã—ã¾ã™ã€‚

```dart
class BottomNavigationBarProvider with ChangeNotifier {
  int _currentIndex = 0;

  int get currentIndex => _currentIndex;

  set currentIndex(int index) {
    _currentIndex = index;
    notifyListeners();
  }
}
```

æ¬¡ã®éƒ¨åˆ†ã§å®Ÿéš›ã«ä¸‹ã«ç½®ã‹ã‚Œã‚‹ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã®UIã‚’è¨˜è¿°ã—ã¦ã„ã¾ã™ã€‚

```dart
class _BottomNavigationBarState extends State<BottomNavigationBarWidget> {
  var currentTab = [
    const Home(),
    const Send(),
    const Wallet(),
  ];

  @override
  Widget build(BuildContext context) {
    var provider = Provider.of<BottomNavigationBarProvider>(context);
    return Scaffold(
      body: currentTab[provider.currentIndex],
      bottomNavigationBar: FluidNavBar(
        icons: [
          FluidNavBarIcon(
            svgPath: "assets/home.svg",
            extras: {"label": "home"},
            backgroundColor:
                provider.currentIndex == 0 ? HexColor("#0C9DB0") : Colors.black,
          ),
          FluidNavBarIcon(
            svgPath: "assets/pay.svg",
            extras: {"label": "send"},
            backgroundColor:
                provider.currentIndex == 1 ? HexColor("#0C9DB0") : Colors.black,
          ),
          FluidNavBarIcon(
            svgPath: "assets/wallet.svg",
            extras: {"label": "wallet"},
            backgroundColor:
                provider.currentIndex == 2 ? HexColor("#0C9DB0") : Colors.black,
          )
        ],
        onChange: (index) => {
          provider.currentIndex = index,
        },
        style: const FluidNavBarStyle(
          iconUnselectedForegroundColor: Colors.grey,
          iconSelectedForegroundColor: Colors.white,
          barBackgroundColor: Colors.black,
        ),
        scaleFactor: 5,
        defaultIndex: 0,
        itemBuilder: (icon, item) => Semantics(
          label: icon.extras!["label"],
          child: item,
        ),
        animationFactor: 0.7,
      ),
    );
  }
}

```

ä»Šå›ã¯`home, send, wallet`ã®3ã¤ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ç”¨æ„ã—ã¦ã„ã¾ã™ã€‚ãã‚Œãã‚Œã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«ã¯ä¸‹ã®ã‚ˆã†ãªæ©Ÿèƒ½ã‚’å‚™ãˆã¦ã„ã¾ã™ã€‚

`home`: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ã€ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’QRã‚³ãƒ¼ãƒ‰ã§è¡¨ç¤ºã§ãã‚‹ã€‚æ®‹é«˜ã‚’å‚ç…§ã§ãã‚‹

`send`:é€é‡‘å…ˆã€é€é‡‘ã™ã‚‹ãƒˆãƒ¼ã‚¯ãƒ³ã¨ãã®é¡ã€å—ã‘å–ã‚‹ãƒˆãƒ¼ã‚¯ãƒ³ã®ç¨®é¡ã‚’é¸æŠã—ã¦é€é‡‘ã§ãã‚‹ã€‚é€é‡‘å…ˆã¯QRã‚³ãƒ¼ãƒ‰ã‹ã‚‰å–å¾—å¯èƒ½ã€‚

`wallet`:ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ã®å‚ç…§ã€QRã‚³ãƒ¼ãƒ‰ã§ã®å‚ç…§ãŒå¯èƒ½ã€‚ã¾ãŸã€ãã‚Œãã‚Œã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚’100weiç²å¾—ã§ãã‚‹ãƒœã‚¿ãƒ³ãŒã‚ã‚‹ã€‚ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚’disconnectã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚

æ¬¡ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’QRã‚³ãƒ¼ãƒ‰åŒ–ã—ã¦è¡¨ç¤ºã™ã‚‹ãŸã‚ã®ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

`lib/view/widgets/qr_code.dart`ã«ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è¨˜è¿°ã—ã¾ã—ã‚‡ã†ã€‚

[`qr_code.dart`]

```dart
import 'package:flutter/material.dart';

class QRCode extends StatefulWidget {
  const QRCode({Key? key, this.qrImage}) : super(key: key);
  final qrImage;
  @override
  State<QRCode> createState() => _QRCodeState();
}

class _QRCodeState extends State<QRCode> {
  @override
  Widget build(BuildContext context) {
    return Dialog(
      child: Container(
        width: 300,
        height: 300,
        child: Center(
          child: widget.qrImage,
        ),
      ),
    );
  }
}
```

ã“ã‚Œã¯éå¸¸ã«å˜ç´”ã§ã€å‰ã®ç”»é¢ã§QRã‚³ãƒ¼ãƒ‰åŒ–ã•ã‚ŒãŸã‚‚ã®ã‚’modalã®å½¢ã§ç”»é¢ä¸Šã«è¡¨ç¤ºã™ã‚‹ã ã‘ãªã®ã§èª¬æ˜ã¯çœç•¥ã—ã¾ã™ã€‚

ã“ã‚Œã§ãã‚Œãã‚Œã®ç”»é¢ã§å¿…è¦ãªã‚‚ã®ã¯ä½œæˆã§ãã¾ã—ãŸï¼

### ğŸ™‹â€â™‚ï¸ è³ªå•ã™ã‚‹

ã“ã“ã¾ã§ã®ä½œæ¥­ã§ä½•ã‹ã‚ã‹ã‚‰ãªã„ã“ã¨ãŒã‚ã‚‹å ´åˆã¯ã€Discordã®`#near`ã§è³ªå•ã‚’ã—ã¦ãã ã•ã„ã€‚

ãƒ˜ãƒ«ãƒ—ã‚’ã™ã‚‹ã¨ãã®ãƒ•ãƒ­ãƒ¼ãŒå††æ»‘ã«ãªã‚‹ã®ã§ã€ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒãƒ¼ãƒˆã«ã¯ä¸‹è¨˜ã®4ç‚¹ã‚’è¨˜è¼‰ã—ã¦ãã ã•ã„ âœ¨

```
1. è³ªå•ãŒé–¢é€£ã—ã¦ã„ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç•ªå·ã¨ãƒ¬ãƒƒã‚¹ãƒ³ç•ªå·
2. ä½•ã‚’ã—ã‚ˆã†ã¨ã—ã¦ã„ãŸã‹
3. ã‚¨ãƒ©ãƒ¼æ–‡ã‚’ã‚³ãƒ”ãƒ¼&ãƒšãƒ¼ã‚¹ãƒˆ
4. ã‚¨ãƒ©ãƒ¼ç”»é¢ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
```

---

section-2-lesson1ã®å®Œäº†ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ ğŸ‰

ã“ã‚Œã§ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã«é–¢ã™ã‚‹å®Ÿè£…ã¯å…¨ã¦å®Œäº†ã—ã¾ã—ãŸï¼ ï¼

æ¬¡ã®ãƒ¬ãƒƒã‚¹ãƒ³ã‹ã‚‰ã¯ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ä½œæˆã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®æ¥ç¶šã‚’ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

ã“ã“ã¾ã§ã¯ã‚³ãƒ¼ãƒ‰ä¸Šã®å®Ÿè£…ã ã‘ã§å®Ÿéš›ã«ç›®ã«è¦‹ãˆãŸã‚‚ã®ãŒã¾ã ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸãŒã€æ¬¡ã‹ã‚‰ã¯å®Ÿæ©Ÿã¾ãŸã¯ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã‚’ä½¿ã„ãªãŒã‚‰ã®å®Ÿè£…ã«ãªã‚‹ã®ã§æ¥½ã—ããªã£ã¦ãã¾ã™ã€‚

æ¬¡ã®Lesson2ã§ãã‚Œãã‚Œã®ç”»é¢ã®UI, UXã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼
